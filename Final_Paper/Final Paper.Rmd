---
title: "Determinants of the Interest in Electric Vehicles"
author: "Claire Chang Liu & Noriko Magara"
date: "Dec. 4th, 2015"
output:
  pdf_document: 
    fig_caption: yes
    number_sections: yes
bibliography: 
 - others.bib
 - Package_Citation.bib
---


```{r results='hide',echo=F, warning=F, message=F, error=F}

### set working directory
setwd("C:/Users/noriko/Desktop/Collaborative-Data-Analysis-Assignment2/Final_Paper")

library(stargazer)
library(knitr)
library(Zelig)
library(rms)
library(captioner)
library(foreign)
library(dplyr)
library(ggplot2)
library(googleVis)
  
figcap <- captioner(prefix = "Figure", auto_space = TRUE, levels = 1, type = NULL)
tablecap <-captioner(prefix = "Table", auto_space = TRUE, levels = 1, type = NULL)
```



For the collaborative research project, we will work on adoption of electric vehicles in the UK, 
focusing on identifying the potential buyers which hopefully helps the UK government to differentiate EV promoting strategies by target groups. 
This document presents detailed proposal for our project.

# Background

As a part of the efforts to cope with the climate change, countries have been trying to reduce greenhouse gas (GHG) emissions. 
Considering the fact that the large portion of GHG emission is attributed to road traffic [@EC_climate], reducing the emission from vehicles is an important issue for many industrialized countries.

Several types of low emission vehicles have been invented and released into the world as listed below [@USDOE].

* Hybrid electric vehicles (HEVs), which use both a conventional inner combustion engine (e.g. gasoline engine) and an electric motor, are the early generation of the low emission vehicles. 
HEVs store electric powers in a battery from braking and the inner combustion engine, which are normally lost in conventional vehicles. 
Thus, HEVs have better fuel efficiency and less emission compared to the conventional vehicles.
* Plug-in hybrid electric vehicles (PHEVs) are the improved version of HEVs. 
PHEVs have a smaller inner combustion engine and more powerful batteries that can be charged by plugging into charging infrastructures, as well as the energy captured from braking and the inner combustion engine. 
Thus, PHEVs have further better fuel efficiency and less emission compared to HEVs.
* Battery Electric Vehicles (BEVs) are the most recent generation of the low emission vehicles, which powered only by an electric motor. 
The batteries that drive the motors are charged by plugging into charging infrastructures. 
Because EVs do not use inner combustion engines at all, they make no emission when they drive.

From the environmental point of view, PHEVs and BEVs are the ideal type of vehicles because they use electric powers from plugs, instead of fossil fuels. 
In this project, we will collectively reffer to them as electric vehicles (EVs).
In reality, however, because of many reasons, the adoption rates of EVs are not as high as the desirable level. 
One of the biggest reasons is the costs. 
Although some articles report that EVs are cheaper than conventional vehicles in long-term thanks to no fuel costs [e.g. @Herron2015web], people tend to refrain from buying EVs because of the high purchase prices.
Also, current technical standards such as battery capacities (maximum driving distance with one-time charging) are pointed out to be an obstacle to the widespread EV adoption [@lieven2011will]. 
Availability of charging stations matters as well [@ChargingStation].
 
Aiming to promote EVs and other types of low emission vehicles, governments have been taking various kinds of means such as financial incentives to owners, R&D grants, installation of charging infrastructures. 
In order to maximize the performance of those governments' efforts, and thus to accelerate low emission vehicle adoption, it is crucial to **identify the characteristics of the potential EV buyers**, and **reasons that makes those potential buyers to choose EVs over conventional vehicles**.

This study will focus on EVs, which is the most recent generation of low emission vehicles and thus not many researches have made so far compared to other types of sustainable vehicles.


# Literature Review

Previous studies have examined various factors that are related to consumers' choice.

At the macro level, the relationship between demographic characteristics and EV adoption has been analyzed. For instance, 
@countrycomparison identify financial incentives, the prevalence of charging stations, and the presence of a local EV manufacturer as the relevant factors, using data on 30 countries. Interestingly, however, they do not find socio-economic variables to be good predicators of a country's EV adoption level. Another macro-level study divides Finland into grids with different socio-economic characteristics and finds that "the income and education level, the amount of families with children and the average size of the residences" (p. 459) are related to the region-level or neighborhood-level adoption rate of EVs [@Finland2013].

At the micro level, motivations and individual characteristics that affect individual choice are studied. 
@egbue2012barriers explores characteristics of potential EV buyers through a survey targeting current conventional vehicle owners, which asked their opinions, perceptions, and attitudes towards EVs, besides socio-economic attributes. 
Using 481 observations gained from the web-based survey, the authors performs chi-square analyses and find out that different groups of people have different stances towards EVs. 
For instance, likelihood to purchase an EV differs by gender, education level, age, and income of respondents. 
In addition, based on the survey questions regarding the respondents' concerns, the authors reveal that more than a quarter of them were unsure about the safety of EVs. 
Therefore, they concluds that people with better knowledge about EVs are more likely to purchase one.  

There are not many studies that observed people who actually bought an EV, possibly resulting from the small adoption rate. 
However, a similar study for another type of low emission vehicle may be helpful to think about the motivations that push people to purchase one. 
@ozaki2011going analyze consumers' motivations to purchase an HEV.
Based on a survey data of HEV owners, the authors discovers that people bought an HEV motivated by environmental benefits, as well as personal economic benefits. 
As a policy implication, advertisements to the public are suggested along with financial incentives to the owners.

In addition, possible policy options to promote low emission vehicle adoption are also covered in several articles.
For an example of PHEVs, @skerlos2010targeting discuss an effective way to allocate government's financial resources. 
Currently, the U.S. federal government provides uniform tax credits to all PHEV owners aiming to expand share of PHEVs in the car market. 
Considering the social benefits of PHEVs including reduced GHG emission, air pollution abatement, increased energy security, the authors argue that the tax credits could have worked better if the government differentiated the incentives depending on consumers' purchasing power and geographical locations. 
As for the purchasing power, more credits to lower income individuals and fewer to higher income ones may have increased PHEV adoption, considering that current level of financial incentives may not be enough for low income people, while high income people would have bought one anyways with less or no financial incentives. 
As for the environmental benefit, PHEV owners in highly populated areas should have received larger credits because one unit reduction of pollution delivers larger benefits (i.e. affects more people). 
It would also be ideal to promote PHEVs in the areas where the electric powers are generated from alternative sources rather than thermal powers that use fossil fuels.

Since policies of financial incentives are the most common one, @givinggreen compare a number of policies to promote EV in different US states. Mainly focusing on the efficacy of sales tax waivers and income tax credits, they find that the former is "associated with ten-fold increase in hybrid sales" (p.1) and that tax incentives are generally more effective than non-tax incentives. 
Thus, both to identifying the characteristics of potential buyers and to design government interventions targeting those individuals are the essential strategies to promote low emission vehicles. 

Regarding EV adoption, more detailed researches that focus on EVs are needed. 
In particular, not many studies have been done on the relationship between EV adoption and individual-level motivations/characteristics, partly due to a lack of survey data on people's attitudes towards EVs that covers both those who buy (or are willing to buy) and those who do not. 
In this study, we will examine the micro-level relationship using a recent dataset from the UK.

# Data Gathering and Methodology
This analysis is based on survey data in the UK called ["Opinions and Lifestyle Survey, Electric Vehicles Module, February 2014 and February 2015"](https://discover.ukdataservice.ac.uk/Catalogue/?sn=7571&type=Data%20catalogue) [@UKDATA]. 
Note that [registration](http://ukdataservice.ac.uk/get-data/how-to-access/registration) is required to download the dataset from the UK Data Service website above.
After logging in and agreeing with the terms of conditions, the datasets are available for download in STATA or other format.
The registration process may take a few days. 
However, other documents (e.g. questionnaire, brief summary) are available at the link above without registration.
This module comes with two datasets: survey results from 2014 and 2015. 
For our study, we use both survey years by combining both datasets together. 

```{r echo=F, warning=F, message=F, error=F}
source("data_cleanup.R")
```

We are interested in the potentially different attitudes and priorities of different groups and in identifying potential buyers of EVs as well as obstacles preventing EV consumption. (To better understand the regional differences, if there are, we will look closer into regional policies or aggregate-level characteristics of Great Britain.) Therefore, we will be using the three core questions as dependent variables and demographic variables as independent variables. We will also be primarily using data from 2015, and might draw on data from 2014 in case of a need for contrast or support. 

As our dependent variables are all categories variables, **multinomial logistic regression** will be adopted:

$$\ln{\frac{Pr(Y_i=1)}{Pr(Y_i=K)}}=\beta_{0,1} + \beta_{1,1} x_{1,i} + \beta_{2,1} x_{2,i} + \dots = \boldsymbol{\beta_1 \cdot x_i}$$
$$\ln{\frac{Pr(Y_i=2)}{Pr(Y_i=K)}}=\boldsymbol{\beta_2 \cdot x_i}$$
$$\vdots$$
$$\ln{\frac{Pr(Y_i=K-1)}{Pr(Y_i=K)}}=\boldsymbol{\beta_{K-1} \cdot x_i}$$

Where $Pr(Y_i=1)$ to $Pr(Y_i=K)$ are the probabilities that the *i*th person is classified into the first category to the *K*th category, and $\boldsymbol{x_i}$ is a vector of the *i*th person's independent variables, i.e. the individual's characteristics in our study. 

By converting the log odds into probabilities, we will obtain the probability of the *i*th person being classified into the *J*th category (e.g. buying an EV) depending on his/her personal characteristics. 
For the *K*th category (the category used as a reference), the predicted probability is calculated by the second formula.

$$Pr(Y_i=J)=\frac{e^{\boldsymbol{\beta_J \cdot x_i}}} {1 + \sum_{k=1}^{K-1} e^{\boldsymbol{\beta_k \cdot x_i}}}$$

$$Pr(Y_i=K)=\frac{1} {1 + \sum_{k=1}^{K-1} e^{\boldsymbol{\beta_k \cdot x_i}}}$$

Thus, we are expecting to see different predicted probabilities of showing certain attitudes or making certain decisions for different demographic groups, which will provide some useful information for the policy makers to create efficient means to promote EVs.

# Descriptive Analysis
## Variables
The list of variables are shown in the table below.

```{r echo=F, warning=F, message=F, error=F, results='asis'}
Names <- c("EVinterest", "RAGE", "Male", "inccat", "degree", "licence", 
           "NumCar", "DVHsize", "havechildren", "Scotland")
Types <- c("dummy", "continuous", "dummy", "categorical", "dummy", 
           "dummy", "continuous", "continuous", "dummy", "dummy")
Descriptions <- c("Whether the respondent is interested in EVs or not", 
                  "Respondent's age",
                  "Respondent's sex",
                  "Respondent's income in 4 categories (low, low-mid, high-mid, high)",
                  "Whether the respondent is a college graduate or not",
                  "Whether the respondent has a valid drivers licence or not",
                  "Number of cars in the respondent's household",
                  "Respondent's household size",
                  "Whether the Respondent has children or not",
                  "Whether the Respondent lives in Scotland or not")
vartable <- cbind(Names, Types, Descriptions)
kable(vartable, caption="List of Variables")
```


## Summary statistics
* **EVinterest**: `r round(mean(EVINTEREST$EVinterest)*100, digits=2)` % of respondents are interested in EVs

* **RAGE**: Mean=`r round(mean(EVINTEREST$RAGE), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$RAGE), digits=2)`.
The distribution of age is shown in figure 1 below.

* **Male**: `r round(mean(EVINTEREST$Male)*100, digits=2)` % of respondents are male

* **inccat**: distribution is shown in table 2 and figure 2 below. 
The thresholds of each category are based on 25, 50, 75 percentile gross income from [Survey of Personal Incomes 2012-13 in the UK](https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/399041/Table_3_1_a_13.xls)(@UKincome).

```{r echo=F, warning=F, message=F, error=F, results='asis'}
inccatcount <- table(EVINTEREST$inccat)
Percentage <- round(inccatcount/length(EVINTEREST$inccat)*100, digits=2)
Income <- c('Low', 'Low-Mid', 'High-Mid', 'High')
Range <- c('Below &#163;14,559', '&#163;14,560~&#163;20,799', 
           '&#163;20,800~&#163;25,999', '&#163;26,000 and Above')
inccatsummary <- cbind(Income, Range, Percentage)
kable(inccatsummary, caption="Distribution of Income")
```

* **degree**: `r round(mean(EVINTEREST$degree)*100, digits=2)` % of respondents have college degree

* **licence**: `r round(mean(EVINTEREST$licence)*100, digits=2)` % of respondents have valid drivers licence

* **NumCar**: Mean=`r round(mean(EVINTEREST$NumCar), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$NumCar), digits=2)`. The distribution of the number of cars in respondent's household is shown in figure 3 below.

* **DVHsize**: Mean=`r round(mean(EVINTEREST$DVHsize), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$DVHsize), digits=2)`. The distribution of household size is shown in figure 4 below.

* **havechildren**: `r round(mean(EVINTEREST$havechildren)*100, digits=2)` % of respondents have children

* **Scotland**: `r round(mean(EVINTEREST$Scotland)*100, digits=2)` % of respondents lives in Scotland

```{r echo=F, warning=F, message=F, error=F, fig.cap="Distribution of respondent's age", fig.height=4}
hist(EVINTEREST$RAGE, main=NULL,
     xlab="Age", ylab="Frequency", 
     xlim=c(10,100))
axis(side=1, at=seq(0,100, 10))
```

```{r echo=F, warning=F, message=F, error=F, fig.cap="Distribution of respondent's income", fig.height=4}
inctable <-table(EVINTEREST$inccat)
barplot(inctable, ylab="Frequnecy",
        names.arg=c("Low", "Low-Mid", "High-Mid", "High"))
mtext(side=1, "Gross Annual Income", line=2)
mtext(side=1, "(Low:~14,559 /Low-Mid:14,560~20,799 /High-Mid:20,800~25,999 /High: 26,000+)", line=3, cex=0.75)
```

```{r echo=F, warning=F, message=F, error=F, fig.cap="Distribution of number of cars", fig.height=4}
cartable <-table(EVINTEREST$NumCar)
barplot(cartable, 
     xlab="Number of Cars", ylab="Frequency")
```

```{r echo=F, warning=F, message=F, error=F, fig.cap="Distribution of household size", fig.height=4}
Hsizetable <- table(EVINTEREST$DVHsize)
barplot(Hsizetable, xlab="Household size", ylab="Frequency")
```

#Logistic Regression
##Modelling
This section presents our efforts to answer the question, "Who are more/less likely to be interested in EVs". Since the dependent variable is a binary variable, i.e. respondents having an interest in EVs or not, we adopt logistic regression models here.

Nine independent variables are categorized into four groups. Socio-economic variables include age, sex, gross annual income level, and education level. The second group includes having driver's license or not, and the number of cars available to the household, which to some extent describe the respondents' potential to buy a new car. The third one is household-level variables, including household size and whether or not having depedent children. The last one is region. (The UK has 11 regions in total. However, our preliminary analysis suggests that, using London as the baseline, only Scotland is significantly different. Therefore, we only include "Scotland" in the regression.)

We only include socio-economic variables in our base model (regression 1) and add in a new group of independent variables each time. As the results in table 3 show, all models are significant at 99% level. Except for the two variables, size of household and having dependent children or not, all other variables are statistically signifcant as well. The fact that household-related variables are effective predictors at macro level, but not at micro level, may suggest a neighborhood effect, but it is beyond the scope of this paper.

```{r echo=F, warning=F, message=F, error=F}
# Estimate model-1 (AGE & SEX & INCOME & Education)
L1 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree, 
           EVINTEREST)

# Estimate model-2 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars)
L2 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar, EVINTEREST)

# Estimate model-3 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars % Number of Children)
L3 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar + DVHsize + havechildren, EVINTEREST)

# Estimate model-4 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars & Number of Children & Scotland)
L4 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar + DVHsize + havechildren + Scotland, EVINTEREST)
```

```{r echo=F, warning=F, message=F, error=F, results='asis'}
labels <- c('Age', 'Male', 'Income: low-middle', 'Income: high-middle', 'Income: high', 
            'College degree', 'Drivers licence', 'Number of cars', "Size of household", 
            'Having dependent children', 'Scotland', '(Intercept)') 

stargazer::stargazer(L1, L2, L3, L4,  type="latex", header=F, covariate.labels = labels,
                     digits = 2, title="Step-wise Modelling")
```

\newpage

Based on this analysis, we leave out the two household-related variables and use the following formula.

$$\ln{(\frac{p} {1-p})}=\beta_{0}+\beta_{1}Age+\beta_{2}Male+\beta_{3}Lowmid+\beta_{4}Highmid+\beta_{5}High+\beta_{6}College$$
$$+\beta_{7}license+\beta_{8}NumCar+\beta_{9}Scotland$$

Where $p$ is the probability of being interested in EVs. The estimated model is shown in table 4.

```{r echo=F, warning=F, message=F, error=F, results='asis'}
finallabels <- c('Age', 'Male', 'Income: low-middle', 'Income: high-middle', 'Income: high', 
            'College degree', 'Drivers licence', 'Number of cars', 'Scotland', '(Intercept)') 
L5 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar + Scotland,
          EVINTEREST)
stargazer::stargazer(L5, type="latex", header=F, covariate.labels = finallabels,
                     digits = 2, title="Interests in EVs")
```

The model is statistically significant at 99% level and five out of the seven variables are significant at 95% level. 
On average, males are more likely to be interested in EVs: 
the odds of being interested in EVs are 60% higher ($e^{0.47}=1.60$) for male than female, holding other variables constant [z=3.36, p<0.001]. 
Having a college degree or driver's license also increases the likelihood of being interested: the odds of having interested in EVs are 92% higher ($e^{0.65}=1.92$) for people with college degree compared to people without [z=4.38, p<0.001], the odds are 148% higher ($e^{0.91}=2.48$) for those who have drivers licence compared to those who don't [z=3.83, p<0.001]. 
The number of cars is positively relative to the likelihood, suggesting that people who already have the "basics" are more likely to consider EVs: each additional car in a househild increases the odds of being interested in EVs by 20% ($e^{0.18}=1.20$), holding other variables constant [z=2.12, p=0.034]. 
However, being in Scotland reduces this likelihood: people who live in Scotland have 50% lower ($e^{-0.7}=0.50$) odds of being interested in EVs compared to people who live in other regions of the UK [z=-2.44, p<0.015]. 

The less significant variables are age and income level. Age is negatively relative to the likelihood of being interested, meaning that younger people are more likely to have an interest in EVs: each one year increase in the respondent's age is associated with 1% decrease ($e^{-0.01}=0.99$) in the odds of having interests in EVs [z=-8.73, p<0.001]. 
Interestingly, income level seems not to matter much. Using the lowest quartile group as the baseline, only the highest quartile group is significantly different: high income people have 34% higher ($e^{0.29}=1.34$) odds of being interested in EVs compared to low income people [z=1.70, p<0.089]. 
Nevertheless, results from regression 1 shows that income level (at least when comparing the highest quartile to the lowest quartile) is statistically significant at 99% level. The decrease in significance is due to the correlation between income level, and having driver's license and number of cars available. 

##Predicted Probabilities of Interest in EVs by Group
In addition to the odds ratio provided in the regression output, we want to be more specific with the size of effects of the seven independent variables. Therefore, the ranges of probability based on the variation of different variables are provided as following.

$$Pr(Interested)=\frac{1} {1 + e^{\boldsymbol{\beta_k \cdot x_i}}}$$

```{r echo=F, warning=F, message=F, error=F, fig.cap="Predicted Probability of Having an Interest in EVs by Age and Sex", fig.height=6}
ZP <- zelig(EVinterest ~ RAGE + Male + lowermiddle + highermiddle + high 
             + degree + licence + NumCar  + Scotland, 
             cite = FALSE, data = EVINTEREST, model = 'logit')
setZP1 <- setx(ZP, RAGE = 20:95, Male=0)
simZP1 <- sim(ZP, x = setZP1)
plot(simZP1, xlab="Age", ylab="Predicted Probability", col=rgb(1,0,0,0.15), 
     ylim=c(0,0.4), xlim=c(20,100))
par(new=T)
setZP1 <- setx(ZP, RAGE = 20:95, Male=1)
simZP1 <- sim(ZP, x = setZP1)
plot(simZP1, xlab="Age", ylab="Predicted Probability", col=rgb(0,0,1,0.15), 
     ylim=c(0,0.4), xlim=c(20,100))
legend("topright", c("Male","Female"),lwd=1, col=c("blue","red"))
```

\newpage

Figure 5 shows the predicted probability of having an interest in EVs by age and sex. Regardless of age, males show a greater interest than females. Even though the variation among males is larger too, the difference in probability is on average about 5 percentage points. The linear relationship between age and this probability is clearly demostrated here as well. Younger people are more likely to be interested than older people.

Table 5-9 summarize predicted probabilities of having an interest in EVs of different groups and allow us to know the differences between groups. 

* By Income Level & Sex: predicted for those people with mean age, valid licence, college degree, a car, and who doesn't live in Scotland.

```{r echo=F, warning=F, message=F, error=F}
# same model with glm
LPred <- glm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high 
             + degree + licence + NumCar + Scotland, 
             data = EVINTEREST, family = 'binomial')

# predicted probability by income group & sex
fitted1 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=c(1,1,1,1),  
                           lowermiddle=c(0,1,0,0), highermiddle=c(0,0,1,0), 
                           high=c(0,0,0,1), licence=1, degree=1, NumCar=1, Scotland=0))
fitted1$predicted <- predict(LPred, newdata = fitted1, type = 'response')
fitted1$predicted <- round(fitted1$predicted*100, digits=2)
fitted2 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=c(0,0,0,0),  
                           lowermiddle=c(0,1,0,0), highermiddle=c(0,0,1,0), 
                           high=c(0,0,0,1), licence=1, degree=1, NumCar=1, Scotland=0))
fitted2$predicted <- predict(LPred, newdata = fitted2, type = 'response')
fitted2$predicted <- round(fitted2$predicted*100, digits=2)

Incomegroup <- c("Lowest quartile", "Second lowest quartile", "Second highest quartile", "Highest quartile")

byincomesex <- cbind(Incomegroup, fitted1$predicted, fitted2$predicted)

kable(byincomesex, caption="Probability by Income Level & Sex", 
      col.names = c("Income Level", "Male", "Female"))
```

* By Education Level & Sex: predicted for those people with mean age, lower-middle income, valid licence, a car, and who doesn't live in Scotland.

```{r echo=F, warning=F, message=F, error=F}
# predicted probability by educ group & sex
fitted3 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=1, lowermiddle=1, 
                           highermiddle=0, high=0,
                           licence=1, degree=c(1,0), NumCar=1, Scotland=0))
fitted3$predicted <- predict(LPred, newdata = fitted3, type = 'response')
fitted3$predicted <- round(fitted3$predicted*100, digits=2)
fitted4 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=0, lowermiddle=1, 
                           highermiddle=0, high=0,
                           licence=1, degree=c(1,0), NumCar=1, Scotland=0))
fitted4$predicted <- predict(LPred, newdata = fitted4, type = 'response')
fitted4$predicted <- round(fitted4$predicted*100, digits=2)

Edugroup <- c("At least have a college degree", "Do not have a college degree")

byedusex <- cbind(Edugroup, fitted3$predicted, fitted4$predicted)

kable(byedusex, caption="Probability by Education Level & Sex", 
      col.names = c("Education Level", "Male", "Female"))
```

* By License Status & Sex: predicted for those people with mean age, lower-middle income, college degree, a car, and who doesn't live in Scotland.

```{r echo=F, warning=F, message=F, error=F}
# predicted probability by licence group & sex
fitted5 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=1, lowermiddle=1, 
                           highermiddle=0, high=0,
                           licence=c(1,0), degree=1, NumCar=1, Scotland=0))
fitted5$predicted <- predict(LPred, newdata = fitted5, type = 'response')
fitted5$predicted <- round(fitted5$predicted*100, digits=2)
fitted6 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=0, lowermiddle=1, 
                           highermiddle=0, high=0,
                           licence=c(1,0), degree=1, NumCar=1, Scotland=0))
fitted6$predicted <- predict(LPred, newdata = fitted6, type = 'response')
fitted6$predicted <- round(fitted6$predicted*100, digits=2)

ligroup <- c("Have driver's license", "Do not have driver's license")

bylisex <- cbind(Edugroup, fitted5$predicted, fitted6$predicted)

kable(bylisex, caption="Probabilities by Driver's License Status & Sex", 
      col.names = c("License Status", "Male", "Female"))
```

* By Number of Cars & Sex: predicted for those people with mean age, lower-middle income, college degree, valid licence, and who doesn't live in Scotland.

```{r echo=F, warning=F, message=F, error=F}
# predicted probability by NumCar & sex
fitted7 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=1, lowermiddle=1, 
                           highermiddle=0, high=0, licence=1, degree=1, 
                           NumCar=c(0,1,2,3), Scotland=0))
fitted7$predicted <- predict(LPred, newdata = fitted7, type = 'response')
fitted7$predicted <- round(fitted7$predicted*100, digits=2)
fitted8 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=0, lowermiddle=1, 
                           highermiddle=0, high=0, licence=1, degree=1, 
                           NumCar=c(0,1,2,3), Scotland=0))
fitted8$predicted <- predict(LPred, newdata = fitted8, type = 'response')
fitted8$predicted <- round(fitted8$predicted*100, digits=2)

bycarsex <- cbind(fitted7$NumCar, fitted7$predicted, fitted8$predicted)

kable(bycarsex, caption="Probabilities by Number of Cars & Sex", 
      col.names = c("Number of Cars", "Male", "Female"))
```

* By Region & Sex: predicted for those people with mean age, lower-middle income, college degree, valid licence, and a car.

```{r echo=F, warning=F, message=F, error=F}
# predicted probability by region & sex
fitted9 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=1, lowermiddle=1, 
                           highermiddle=0, high=0, licence=1, degree=1, 
                           NumCar=1, Scotland=c(1,0)))
fitted9$predicted <- predict(LPred, newdata = fitted9, type = 'response')
fitted9$predicted <- round(fitted9$predicted*100, digits=2)
fitted10 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=0, lowermiddle=1, 
                           highermiddle=0, high=0, licence=1, degree=1, 
                           NumCar=1, Scotland=c(1,0)))
fitted10$predicted <- predict(LPred, newdata = fitted10, type = 'response')
fitted10$predicted <- round(fitted10$predicted*100, digits=2)

scotgroup <- c("In Scotland", "In other regions")

byscotsex <- cbind(scotgroup, fitted9$predicted, fitted10$predicted)

kable(byscotsex, caption="Probabilities by Region & Sex", 
      col.names = c("Region", "Male", "Female"))
```

##Obstacles to Buying an EV

In order to further investigate why people refrain from buying an EV, the survey asks questions regarding things that discourage the respondents doing so.

### General obstacles

The graph below shows the major obstacles to buying an EV. 
The most popular issue is the recharging of the EVs, as `r round(mean(EVINTEREST$POrecharge)*100, digits=2)`% of respondents answered that they are concerned about it.
The second largest issue is the capasity of the batteries, which is crucial to the travel distance. `r round(mean(EVINTEREST$PObattery)*100, digits=2)`% of renspondents are concerned about it, followed by the high costs of EVs (`r round(mean(EVINTEREST$POcost)*100, digits=2)`%).

```{r echo=F, warning=F, message=F, error=F, fig.cap="Obstacles to buying an EV"}
### Main Obstacles ###
obscat <- c('choice', 'knowledge', 'cost', 'battery', 'recharge', 
            'resale', 'safety', 'spec', 'technology')
obsmean <- c(mean(EVINTEREST$POchoice), mean(EVINTEREST$POknowledge),
             mean(EVINTEREST$POcost), mean(EVINTEREST$PObattery),
             mean(EVINTEREST$POrecharge), mean(EVINTEREST$POresale),
             mean(EVINTEREST$POsafety), mean(EVINTEREST$POcarspec),
             mean(EVINTEREST$POtech))
barplot(obsmean, names.arg=obscat, cex.names=0.6,
        ylab="% of respondents who choose the category")
```

This result instantly suggests that the government may encourage people to buy an EV by increasing the number of EV charging stations, subsidizing R&D of the EV industry to accelerate the technical development, and/or providing financial incentives such as tax exemption or rebates to those who purchase an EV.
However, logistic regression models identifies which groups of people care more about each of the three major obstacles as shown in the table below. 

```{r  echo=F, warning=F, message=F, error=F, results='asis'}
# Recharge
Obs1 <- lrm(POrecharge ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
            + licence + NumCar + Scotland,
            EVINTEREST)
# Battery
Obs2 <- lrm(PObattery ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
            + licence + NumCar + Scotland,
            EVINTEREST)
# Cost
Obs3 <- lrm(POcost ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
            + licence + NumCar + Scotland,
            EVINTEREST)
# summary table
stargazer(Obs1, Obs2, Obs3, type="latex", header=F, covariate.labels = finallabels,
          digits = 2, title="Determinats of obstacles")
```

As for the recharging issue, males, college graduates, people who have a drivers licence, and people who have more car are more likely to be concerned about it compared to females, non-college graduates, people without drivers licence, and people who have fewer cars, respectively.
Similarly, as for the battery capacity issue, males, college graduates, people who have a drivers licence, people who have more car, and people live outside Scotland are more likely to be concerned about it compared to females, non-college graduates, people without drivers licence, people who have fewer cars, and people live in Scotland, respectively.
Finally, regarding costs, younger people, males, college graduates, and people who have a drivers licence are more likely to be concerned about it compared to older people, females, non-college graduates, and people without drivers licence, respectively.
Although the more sensitive groups slightly differ by the obstacles, they are generally consistent with the groups that are more likely to be interested in EVs. 
This result implies that people who have stronger interests in EVs are at the same time more concerned about those obstacles.   


### Obstacles regarding costs
The survey also asks what aspects of the costs people are concerned about. 
As shown in the graph below, `r round(mean(EVINTEREST$POCpurchase)*100, digits=2)`% of respondents think that the purchasing costs would put them off buying an EV. The other major concerns are the maintenance costs (`r round(mean(EVINTEREST$POCmaintenance)*100, digits=2)`%) and the fuel/recharging costs including fuel tax (`r round(mean(EVINTEREST$POCfuel)*100, digits=2)`%). 

```{r echo=F, warning=F, message=F, error=F, fig.cap="Obstacles to buying an EV regarding costs"}
cobscat <- c('purchase', 'fuel/charging', 'maintenance', 'resale', 'excise tax',
             'company tax', 'insurance')
cobsmean <- c(mean(EVINTEREST$POCpurchase), mean(EVINTEREST$POCfuel),
              mean(EVINTEREST$POCmaintenance), mean(EVINTEREST$POCresale),
              mean(EVINTEREST$POCextax), mean(EVINTEREST$POCcomptax),
              mean(EVINTEREST$POCinsurance))
barplot(cobsmean, names.arg=cobscat, cex.names=0.6,
        ylab="% of respondents who choose the category")
```

The table below shows the results of logistic regression models for the three major concerns regarding costs.
Younger people, male, college graduates, and people with a drivers licence are more likely to be concerned about purchasing costs, compared to older people, females, non-college graduates, and people without drivers licence.
Likewise, younger people, males, people with a drivers licence, and people live outside Scotland are more likely to be concerned about maintenance costs, compared to each counterpart.
Interestingly, regarding fuel and recharging costs, the lower-middle and the higher-middle income group are more likely to be concerned compared to the low income group. 
People who have a drivers licence have strong concerns on this issue as well.
In fact, EVs are cheaper than conventional vehicles in terms of fuel/recharge costs as @Herron2015web argues.
Better understanding about the actual energy costs may help motivate these people to consider buying one.

```{r echo=F, warning=F, message=F, error=F, results='asis'}
# Purchase
Cobs1 <- lrm(POCpurchase ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
             + licence + NumCar + Scotland,
             EVINTEREST)
# maintenance
Cobs2 <- lrm(POCmaintenance ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
             + licence + NumCar + Scotland,
             EVINTEREST)
# Cost
Cobs3 <- lrm(POCfuel ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
             + licence + NumCar + Scotland,
             EVINTEREST)
# summary table
stargazer(Cobs1, Cobs2, Cobs3, type="latex", header=F, covariate.labels = finallabels,
          digits = 2, title="Determinats of obstacles regarding costs")
```

\newpage

##Encouragements

Since the survey also asks respondents what would encourage them to buy an EV, we will provide a descriptive and analytical analysis of these factors here in the hope that the results will inform our policy recommendation.

The choices provided in the survey and their relative importance in the respondents' minds are shown in the figure xxx.

```{r echo=F, warning=F, message=F, error=F, results='asis'}
ennames <- c('Cost', 'Battery: \n distance travelled \n on charge', 'Convenience \n of recharging', 'Resale/residual \n value', 'Safety \n features/record', 'Vehicle size, \n performance \n or aesthetics', 'If there was \n more choice \n available', 'Technology: \n reliable/proven', 'Environmentally \n friendly')
enmeans <- c(mean(EVINTEREST$ENcost), mean(EVINTEREST$ENbattery),
             mean(EVINTEREST$ENrecharge), mean(EVINTEREST$ENresale),
             mean(EVINTEREST$ENsafety), mean(EVINTEREST$ENcarspec),
             mean(EVINTEREST$ENchoice), mean(EVINTEREST$ENtech),
             mean(EVINTEREST$ENenv))
barplot(enmeans, names.arg=ennames, cex.names=0.6,
        ylab="% of respondents who choose the category")
```

Among the nine choices, the top four choices are: "Cost" with `r round(mean(EVINTEREST$ENcost)*100, digits=2)`% respondents choosing it, "Battery: distance travelled on charge" with `r round(mean(EVINTEREST$ENbattery)*100, digits=2)`%, "Convenience of recharging" with `r round(mean(EVINTEREST$ENrecharge)*100, digits=2)`%, and "Environmentally friendly" with `r round(mean(EVINTEREST$ENenv)*100, digits=2)`%. 

The facts above potentially reveal a public interest in EVs. If there were no interest at all, people would not have bothered to learn about EVs' battery capacity and recharging condition. These again show the practical problems related to EVs and will lead to similar policy suggestions above, i.e. more support to R&D in EVs and more charging stations.

As in the previous section, we here break down the factor "cost" and see what exactly is cost about.

```{r echo=F, warning=F, message=F, error=F, results='asis'}
encostnames <-  c('purchase', 'fuel/recharging', 'maintenance', 'resale', 'excise tax',
             'company tax', 'insurance')
encostmeans <- c(mean(EVINTEREST$ENCpurchase), mean(EVINTEREST$ENCfuel),
             mean(EVINTEREST$ENCmaintenance), mean(EVINTEREST$ENCresale),
             mean(EVINTEREST$ENCextax), mean(EVINTEREST$ENCcomptac),
             mean(EVINTEREST$ENCinsurance))
barplot(encostmeans, names.arg=encostnames, cex.names=0.6,
        ylab="% of respondents who choose the category")
```

Admittedly, this question is rather vague, because it only gives us the information regarding what kind of cost matters most to consumers, but not how they think of the costs at current levels. However, a comparison between the costs that will put off buying EVs and the costs that will encourage buying is interesting. While the top four choices are the same, purchase costs, fuel/recharging costs, maintenance costs, and insurances costs, more people are put off by fuel/recharging costs or insurance costs. This shows that people are worried about the recharging costs for EVs which actually have a lower energy cost per mile than ordinary cars.As for insurance costs, it is true that premium for EVs is higher, but it could be reduced as EVs become more prevalent.

Now we turn to potentially different considerations held by different groups of people.

```{r echo=F, warning=F, message=F, error=F, results='asis'}

en1 <- lrm(ENcost ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
             + licence + NumCar + Scotland,
             EVINTEREST)

en2 <- lrm(ENbattery ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
             + licence + NumCar + Scotland,
             EVINTEREST)

en3 <- lrm(ENrecharge ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
             + licence + NumCar + Scotland,
             EVINTEREST)

en4 <- lrm(ENenv ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
             + licence + NumCar + Scotland,
             EVINTEREST)

stargazer(en1, en2, en3, en4,type="latex", header=F, covariate.labels = finallabels,
          digits = 2, title="Determinats of factors that will be encourage buying EVs")
```


#Discussion and Limitations
In general, interest in EVs is rather limited. Among all respondents, only 18.48% are interested. This, on the other hand, suggests the need to better understand the factors related to the interest in EVs, and this is what motivated our research too.

Above analysis shows that the variations among different groups are quite large. For instance, people having a college degree, on average, have a probability of 30.7% to be interested in EVs, while people without a degree only have a probability of 14.5%. This kind of variation (especially the one related to education level) is actually a good sign, suggesting that interest in EVs could be potentially increased. Promotion of EVs should give more attention to the needs and comsumption patterns of low-interest groups. 

However, this also leads to one of the limitations of this paper, not being able answer why different groups show different levels of interest. This question is very hard, not just because we do not have more detailed surveys, but also because different groups may be systematically different in many unobeserved ways. Even though, we will still attempt to make contributions on this question in our final paper.

Another limitation is due to the design of the survey, which did not exclude respondents who are not interested in buying cars in genereal. Therefore, varialbes, including having driver's license and number of cars available, need to be interpreted with great caution. The low interest shown in groups without driver's license or cars might not be caused by their lack of interest in EVs, but by their lack of interest in cars.

Lastly, $R^2$ of the model is only 0.12, meaning that these variables only explain 12% of the variations in the probability of having an interest in EVs. Partly, this is because of a lack of available information, as it is impossible to survey everything. Partly, attitudes are just not easy to explain, because they could be influenced by countless factors, sometimes as trivial as an image or some careless words. Nevertheless, we believe that there are patterns and these patterns are what we should better understand if EVs are to be further promoted.

# Reference

---
nocite: | 
  @CiteR,@R-captioner,@R-dplyr,@R-foreign,@R-ggplot2,@R-googleVis,@R-knitr,@R-markdown,@R-repmis,@R-rms,@R-stargazer,@R-Zelig
...
