---
title: "Determinants of the Interest in Electric Vehicles"
author: "Claire Chang Liu & Noriko Magara"
date: "Dec. 4th, 2015"
output:
  pdf_document: 
    fig_caption: yes
    number_sections: yes
bibliography: 
 - others.bib
 - Package_Citation.bib
---


```{r results='hide',echo=F, warning=F, message=F, error=F}

### set working directory
possible_wd <- c("E:\\Ñ§Ï°Ïà¹Ø\\R\\Collaborative-Data-Analysis-Assignment2\\Final_Paper", "C:/Users/noriko/Desktop/Collaborative-Data-Analysis-Assignment2/Final_Paper")
repmis::set_valid_wd(possible_wd)

library(stargazer)
library(knitr)
library(Zelig)
library(rms)
library(captioner)
library(foreign)
library(dplyr)
library(ggplot2)
library(googleVis)
library(gridExtra)
  
figcap <- captioner(prefix = "Figure", auto_space = TRUE, levels = 1, type = NULL)
tablecap <-captioner(prefix = "Table", auto_space = TRUE, levels = 1, type = NULL)
```



For the collaborative research project, we will work on adoption of electric vehicles in the UK, 
focusing on identifying the potential buyers which hopefully helps the UK government to differentiate EV promoting strategies by target groups. 
This document presents detailed proposal for our project.

# Background

As a part of the efforts to cope with the climate change, countries have been trying to reduce greenhouse gas (GHG) emissions. 
Considering the fact that the large portion of GHG emission is attributed to road traffic [@EC_climate], reducing the emission from vehicles is an important issue for many industrialized countries.

Several types of low emission vehicles have been invented and released into the world as listed below [@USDOE].

* Hybrid electric vehicles (HEVs), which use both a conventional inner combustion engine (e.g. gasoline engine) and an electric motor, are the early generation of the low emission vehicles. 
HEVs store electric powers in a battery from braking and the inner combustion engine, which are normally lost in conventional vehicles. 
Thus, HEVs have better fuel efficiency and less emission compared to the conventional vehicles.
* Plug-in hybrid electric vehicles (PHEVs) are the improved version of HEVs. 
PHEVs have a smaller inner combustion engine and more powerful batteries that can be charged by plugging into charging infrastructures, as well as the energy captured from braking and the inner combustion engine. 
Thus, PHEVs have further better fuel efficiency and less emission compared to HEVs.
* Battery Electric Vehicles (BEVs) are the most recent generation of the low emission vehicles, which powered only by an electric motor. 
The batteries that drive the motors are charged by plugging into charging infrastructures. 
Because EVs do not use inner combustion engines at all, they make no emission when they drive.

From the environmental point of view, PHEVs and BEVs are the ideal type of vehicles because they use electric powers from plugs, instead of fossil fuels. 
In this project, we will collectively refer to them as electric vehicles (EVs).
In reality, however, because of many reasons, the adoption rates of EVs are not as high as the desirable level. 
One of the biggest reasons is the costs. 
Although some articles report that EVs are cheaper than conventional vehicles in long-term thanks to no fuel costs [e.g. @Herron2015web], people tend to refrain from buying EVs because of the high purchase prices.
Also, current technical standards such as battery capacities (maximum driving distance with one-time charging) are pointed out to be an obstacle to the widespread EV adoption [@lieven2011will]. 
Availability of charging stations matters as well [@ChargingStation].
 
Aiming to promote EVs and other types of low emission vehicles, governments have been taking various kinds of means such as financial incentives to owners, R&D grants, installation of charging infrastructures. 
In order to maximize the performance of those governments' efforts, and thus to accelerate low emission vehicle adoption, it is crucial to **identify the characteristics of the potential EV buyers**, and **reasons that makes those potential buyers to choose EVs over conventional vehicles**.

This study will focus on EVs, which is the most recent generation of low emission vehicles and thus not many researches have made so far compared to other types of sustainable vehicles.


# Literature Review

Previous studies have examined various factors that are related to consumers' choice.

At the macro level, the relationship between demographic characteristics and EV adoption has been analyzed. For instance, 
@countrycomparison identify financial incentives, the prevalence of charging stations, and the presence of a local EV manufacturer as the relevant factors, using data on 30 countries. Interestingly, however, they do not find socio-economic variables to be good predictors of a country's EV adoption level. Another macro-level study divides Finland into grids with different socio-economic characteristics and finds that "the income and education level, the amount of families with children and the average size of the residences" (p. 459) are related to the region-level or neighborhood-level adoption rate of EVs [@Finland2013].

At the micro level, motivations and individual characteristics that affect individual choice are studied. 
@egbue2012barriers explores characteristics of potential EV buyers through a survey targeting current conventional vehicle owners, which asked their opinions, perceptions, and attitudes towards EVs, besides socio-economic attributes. 
Using 481 observations gained from the web-based survey, the authors performs chi-square analyses and find out that different groups of people have different stances towards EVs. 
For instance, likelihood to purchase an EV differs by gender, education level, age, and income of respondents. 
In addition, based on the survey questions regarding the respondents' concerns, the authors reveal that more than a quarter of them were unsure about the safety of EVs. 
Therefore, they concludes that people with better knowledge about EVs are more likely to purchase one.  

There are not many studies that observed people who actually bought an EV, possibly resulting from the small adoption rate. 
However, a similar study for another type of low emission vehicle may be helpful to think about the motivations that push people to purchase one. 
@ozaki2011going analyze consumers' motivations to purchase an HEV.
Based on a survey data of HEV owners, the authors discovers that people bought an HEV motivated by environmental benefits, as well as personal economic benefits. 
As a policy implication, advertisements to the public are suggested along with financial incentives to the owners.

In addition, possible policy options to promote low emission vehicle adoption are also covered in several articles.
For an example of PHEVs, @skerlos2010targeting discuss an effective way to allocate government's financial resources. 
Currently, the U.S. federal government provides uniform tax credits to all PHEV owners aiming to expand share of PHEVs in the car market. 
Considering the social benefits of PHEVs including reduced GHG emission, air pollution abatement, increased energy security, the authors argue that the tax credits could have worked better if the government differentiated the incentives depending on consumers' purchasing power and geographical locations. 
As for the purchasing power, more credits to lower income individuals and fewer to higher income ones may have increased PHEV adoption, considering that current level of financial incentives may not be enough for low income people, while high income people would have bought one anyways with less or no financial incentives. 
As for the environmental benefit, PHEV owners in highly populated areas should have received larger credits because one unit reduction of pollution delivers larger benefits (i.e. affects more people). 
It would also be ideal to promote PHEVs in the areas where the electric powers are generated from alternative sources rather than thermal powers that use fossil fuels.

Since policies of financial incentives are the most common one, @givinggreen compare a number of policies to promote EV in different US states. Mainly focusing on the efficacy of sales tax waivers and income tax credits, they find that the former is "associated with ten-fold increase in hybrid sales" (p.1) and that tax incentives are generally more effective than non-tax incentives. 
Thus, both to identifying the characteristics of potential buyers and to design government interventions targeting those individuals are the essential strategies to promote low emission vehicles. 

Regarding EV adoption, more detailed researches that focus on EVs are needed. 
In particular, not many studies have been done on the relationship between EV adoption and individual-level motivations/characteristics, partly due to a lack of survey data on people's attitudes towards EVs that covers both those who buy (or are willing to buy) and those who do not. 
In this study, we will examine the micro-level relationship using a recent data set from the UK.

# Data Gathering and Methodology
This analysis is based on survey data in the UK called ["Opinions and Lifestyle Survey, Electric Vehicles Module, February 2014 and February 2015"](https://discover.ukdataservice.ac.uk/Catalogue/?sn=7571&type=Data%20catalogue) [@UKDATA]. 
Note that [registration](http://ukdataservice.ac.uk/get-data/how-to-access/registration) is required to download the data set from the UK Data Service website above.
After logging in and agreeing with the terms of conditions, the data sets are available for download in STATA or other format.
The registration process may take a few days. 
However, other documents (e.g. questionnaire, brief summary) are available at the link above without registration.
This module comes with two data sets: survey results from 2014 and 2015. 
For our study, we use both survey years by combining both data sets together. 

```{r echo=F, warning=F, message=F, error=F}
source("data_cleanup.R")
```

We are interested in the potentially different attitudes and priorities of different groups and in identifying potential buyers of EVs as well as obstacles preventing EV consumption. (To better understand the regional differences, if there are, we will look closer into regional policies or aggregate-level characteristics of Great Britain.) Therefore, we will be using the three core questions as dependent variables and demographic variables as independent variables. We will also be primarily using data from 2015, and might draw on data from 2014 in case of a need for contrast or support. 

As our dependent variables are all binary dummy variables, **logistic regression** will be adopted:

$$\ln{\frac{p}{1-p}}=\beta_{0} + \beta_{1} x_{1i} + \beta_{2} x_{2i} + \dots + \beta_{k} x_{ki}$$

Where $p$ is the probability that the dependent variable equals to 1 (e.g. being interested in EVs).

By converting $\ln{\frac{p}{1-p}}$ into $p$, we will obtain the predicted probability for the *i*th person depending on his/her personal characteristics. 

$$p=\frac{1} {1 + exp\{-(\beta_{0} + \beta_{1} x_{1i} + \beta_{2} x_{2i} + \dots + \beta_{k} x_{ki})\}}$$

Thus, we are expecting to see different predicted probabilities of showing certain attitudes or making certain decisions for different demographic groups, which will provide some useful information for the policy makers to create efficient means to promote EVs.

# Analysis
## Descriptive Analysis
### Variables
The list of variables are shown in the table below.

```{r echo=F, warning=F, message=F, error=F, results='asis'}
Names <- c("EVinterest", "RAGE", "Male", "inccat", "degree", "licence", 
           "NumCar", "DVHsize", "havechildren", "Scotland")
Types <- c("dummy", "continuous", "dummy", "categorical", "dummy", 
           "dummy", "continuous", "continuous", "dummy", "dummy")
Descriptions <- c("Whether the respondent is interested in EVs or not", 
                  "Respondent's age",
                  "Respondent's sex",
                  "Respondent's income in 4 categories (low, low-mid, high-mid, high)",
                  "Whether the respondent is a college graduate or not",
                  "Whether the respondent has a valid drivers licence or not",
                  "Number of cars in the respondent's household",
                  "Respondent's household size",
                  "Whether the Respondent has children or not",
                  "Whether the Respondent lives in Scotland or not")
vartable <- cbind(Names, Types, Descriptions)
kable(vartable, caption="List of Variables")
```


### Summary statistics
* **EVinterest**: `r round(mean(EVINTEREST$EVinterest)*100, digits=2)` % of respondents are interested in EVs

* **RAGE**: Mean=`r round(mean(EVINTEREST$RAGE), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$RAGE), digits=2)`.
The distribution of age is shown in figure 1 below.

* **Male**: `r round(mean(EVINTEREST$Male)*100, digits=2)` % of respondents are male

* **inccat**: distribution is shown in table 2 and figure 2 below. 
The thresholds of each category are based on 25, 50, 75 percentile gross income from [Survey of Personal Incomes 2012-13 in the UK](https://www.gov.uk/government/uploads/system/uploads/attachment_data/file/399041/Table_3_1_a_13.xls)(@UKincome).

```{r echo=F, warning=F, message=F, error=F, results='asis'}
inccatcount <- table(EVINTEREST$inccat)
Percentage <- round(inccatcount/length(EVINTEREST$inccat)*100, digits=2)
Income <- c('Low', 'Low-Mid', 'High-Mid', 'High')
Range <- c('Below &#163;14,559', '&#163;14,560~&#163;20,799', 
           '&#163;20,800~&#163;25,999', '&#163;26,000 and Above')
inccatsummary <- cbind(Income, Range, Percentage)
kable(inccatsummary, caption="Distribution of Income")
```

* **degree**: `r round(mean(EVINTEREST$degree)*100, digits=2)` % of respondents have college degree

* **licence**: `r round(mean(EVINTEREST$licence)*100, digits=2)` % of respondents have valid drivers licence

* **NumCar**: Mean=`r round(mean(EVINTEREST$NumCar), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$NumCar), digits=2)`. The distribution of the number of cars in respondent's household is shown in figure 3 below.

* **DVHsize**: Mean=`r round(mean(EVINTEREST$DVHsize), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$DVHsize), digits=2)`. The distribution of household size is shown in figure 4 below.

* **havechildren**: `r round(mean(EVINTEREST$havechildren)*100, digits=2)` % of respondents have children

* **Scotland**: `r round(mean(EVINTEREST$Scotland)*100, digits=2)` % of respondents lives in Scotland

```{r echo=F, warning=F, message=F, error=F, fig.cap="Distribution of respondent's age", fig.height=4}
hist(EVINTEREST$RAGE, main=NULL,
     xlab="Age", ylab="Frequency", 
     xlim=c(10,100))
axis(side=1, at=seq(0,100, 10))
```

```{r echo=F, warning=F, message=F, error=F, fig.cap="Distribution of respondent's income", fig.height=4}
inctable <-table(EVINTEREST$inccat)
barplot(inctable, ylab="Frequnecy",
        names.arg=c("Low", "Low-Mid", "High-Mid", "High"))
mtext(side=1, "Gross Annual Income", line=2)
mtext(side=1, "(Low:~14,559 /Low-Mid:14,560~20,799 /High-Mid:20,800~25,999 /High: 26,000+)", line=3, cex=0.75)
```

```{r echo=F, warning=F, message=F, error=F, fig.cap="Distribution of number of cars", fig.height=4}
cartable <-table(EVINTEREST$NumCar)
barplot(cartable, 
     xlab="Number of Cars", ylab="Frequency")
```

```{r echo=F, warning=F, message=F, error=F, fig.cap="Distribution of household size", fig.height=4}
Hsizetable <- table(EVINTEREST$DVHsize)
barplot(Hsizetable, xlab="Household size", ylab="Frequency")
```

##Logistic Regression
###Modelling
This section presents our efforts to answer the question, "Who are more/less likely to be interested in EVs". Since the dependent variable is a binary variable, i.e. respondents having an interest in EVs or not, we adopt logistic regression models here.

Nine independent variables are categorized into four groups. Socio-economic variables include age, sex, gross annual income level, and education level. The second group includes having driver's license or not, and the number of cars available to the household, which to some extent describe the respondents' potential to buy a new car. The third one is household-level variables, including household size and whether or not having dependent children. The last one is region. (The UK has 11 regions in total. However, our preliminary analysis suggests that, using London as the baseline, only Scotland is significantly different. Therefore, we only include "Scotland" in the regression.)

We only include socio-economic variables in our base model (regression 1) and add in a new group of independent variables each time. As the results in table 3 show, all models are significant at 99% level. Except for the two variables, size of household and having dependent children or not, all other variables are statistically significant as well. The fact that household-related variables are effective predictors at macro level, but not at micro level, may suggest a neighborhood effect, but it is beyond the scope of this paper.

```{r echo=F, warning=F, message=F, error=F}
# Estimate model-1 (AGE & SEX & INCOME & Education)
L1 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree, 
           EVINTEREST)

# Estimate model-2 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars)
L2 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar, EVINTEREST)

# Estimate model-3 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars % Number of Children)
L3 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar + DVHsize + havechildren, EVINTEREST)

# Estimate model-4 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars & Number of Children & Scotland)
L4 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar + DVHsize + havechildren + Scotland, EVINTEREST)
```

```{r echo=F, warning=F, message=F, error=F, results='asis'}
labels <- c('Age', 'Male', 'Income: low-middle', 'Income: high-middle', 'Income: high', 
            'College degree', 'Drivers licence', 'Number of cars', "Size of household", 
            'Having dependent children', 'Scotland', '(Intercept)') 

stargazer::stargazer(L1, L2, L3, L4,  type="latex", header=F, covariate.labels = labels,
                     digits = 2, title="Step-wise Modelling")
```

\newpage

Based on this analysis, we leave out the two household-related variables and use the following formula.

$$\ln{(\frac{p} {1-p})}=\beta_{0}+\beta_{1}Age+\beta_{2}Male+\beta_{3}Lowmid+\beta_{4}Highmid+\beta_{5}High+\beta_{6}College$$
$$+\beta_{7}license+\beta_{8}NumCar+\beta_{9}Scotland$$

Where $p$ is the probability of being interested in EVs. The estimated model is shown in table 4.

```{r echo=F, warning=F, message=F, error=F, results='asis'}
finallabels <- c('Age', 'Male', 'Income: low-middle', 'Income: high-middle', 'Income: high', 
            'College degree', 'Drivers licence', 'Number of cars', 'Scotland', '(Intercept)') 
L5 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar + Scotland,
          EVINTEREST)
stargazer::stargazer(L5, type="latex", header=F, covariate.labels = finallabels,
                     digits = 2, title="Interests in EVs")
```

$$\ln{(\frac{p} {1-p})}=\underset{(.29)}{-2.56}-\underset{(.004)}{.01Age}+\underset{(.14)}{.47Male}\underset{(.21)}{-.10Lowmid}+\underset{(.24)}{.03Highmid}$$

$$+\underset{(.17)}{.29High}+\underset{(.15)}{.65College}+\underset{(.24)}{.91license}+\underset{(.09)}{.18NumCar}-\underset{(.29^)}{.70Scotland}$$

The model is statistically significant at 99% level and five out of the seven variables are significant at 95% level. 
On average, males are more likely to be interested in EVs: 
the odds of being interested in EVs are 60% higher ($e^{0.47}=1.60$) for male than female, holding other variables constant [z=3.36, p<0.001]. 
Having a college degree or driver's license also increases the likelihood of being interested: the odds of having interested in EVs are 92% higher ($e^{0.65}=1.92$) for people with college degree compared to people without [z=4.38, p<0.001], the odds are 148% higher ($e^{0.91}=2.48$) for those who have drivers licence compared to those who don't [z=3.83, p<0.001]. 
The number of cars is positively relative to the likelihood, suggesting that people who already have the "basics" are more likely to consider EVs: each additional car in a household increases the odds of being interested in EVs by 20% ($e^{0.18}=1.20$), holding other variables constant [z=2.12, p=0.034]. 
However, being in Scotland reduces this likelihood: people who live in Scotland have 50% lower ($e^{-0.7}=0.50$) odds of being interested in EVs compared to people who live in other regions of the UK [z=-2.44, p<0.015]. 

The less significant variables are age and income level. Age is negatively relative to the likelihood of being interested, meaning that younger people are more likely to have an interest in EVs: each one year increase in the respondent's age is associated with 1% decrease ($e^{-0.01}=0.99$) in the odds of having interests in EVs [z=-8.73, p<0.001]. 
Interestingly, income level seems not to matter much. Using the lowest quartile group as the baseline, only the highest quartile group is significantly different: high income people have 34% higher ($e^{0.29}=1.34$) odds of being interested in EVs compared to low income people [z=1.70, p<0.089]. 
Nevertheless, results from regression 1 shows that income level (at least when comparing the highest quartile to the lowest quartile) is statistically significant at 99% level. The decrease in significance is due to the correlation between income level, and having driver's license and number of cars available. 

###Predicted Probabilities of Interest in EVs by Group
In addition to the odds ratio provided in the regression output, we want to be more specific with the size of effects of the seven independent variables. Therefore, the ranges of probability based on the variation of different variables are provided as following.

$$Pr(Interested)=\frac{1} {1 + e^{\boldsymbol{\beta_k \cdot x_i}}}$$

```{r echo=F, warning=F, message=F, error=F, fig.cap="Predicted Probability of Having an Interest in EVs by Age and Sex", fig.height=6}
ZP <- zelig(EVinterest ~ RAGE + Male + lowermiddle + highermiddle + high 
             + degree + licence + NumCar  + Scotland, 
             cite = FALSE, data = EVINTEREST, model = 'logit')
setZP1 <- setx(ZP, RAGE = 20:95, Male=0)
simZP1 <- sim(ZP, x = setZP1)
plot(simZP1, xlab="Age", ylab="Predicted Probability", col=rgb(1,0,0,0.15), 
     ylim=c(0,0.4), xlim=c(20,100))
par(new=T)
setZP1 <- setx(ZP, RAGE = 20:95, Male=1)
simZP1 <- sim(ZP, x = setZP1)
plot(simZP1, xlab="Age", ylab="Predicted Probability", col=rgb(0,0,1,0.15), 
     ylim=c(0,0.4), xlim=c(20,100))
legend("topright", c("Male","Female"),lwd=1, col=c("blue","red"))
```

\newpage

Figure 5 shows the predicted probability of having an interest in EVs by age and sex. Regardless of age, males show a greater interest than females. Even though the variation among males is larger too, the difference in probability is on average about 5 percentage points. The linear relationship between age and this probability is clearly demonstrated here as well. Younger people are more likely to be interested than older people.

Table 5-9 summarize predicted probabilities of having an interest in EVs of different groups and allow us to know the differences between groups. 

* By Income Level & Sex: predicted for those people with mean age, valid licence, college degree, a car, and who doesn't live in Scotland.

```{r echo=F, warning=F, message=F, error=F}
# same model with glm
LPred <- glm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high 
             + degree + licence + NumCar + Scotland, 
             data = EVINTEREST, family = 'binomial')

# predicted probability by income group & sex
fitted1 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=c(1,1,1,1),  
                           lowermiddle=c(0,1,0,0), highermiddle=c(0,0,1,0), 
                           high=c(0,0,0,1), licence=1, degree=1, NumCar=1, Scotland=0))
fitted1$predicted <- predict(LPred, newdata = fitted1, type = 'response')
fitted1$predicted <- round(fitted1$predicted*100, digits=2)
fitted2 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=c(0,0,0,0),  
                           lowermiddle=c(0,1,0,0), highermiddle=c(0,0,1,0), 
                           high=c(0,0,0,1), licence=1, degree=1, NumCar=1, Scotland=0))
fitted2$predicted <- predict(LPred, newdata = fitted2, type = 'response')
fitted2$predicted <- round(fitted2$predicted*100, digits=2)

Incomegroup <- c("Lowest quartile", "Second lowest quartile", "Second highest quartile", "Highest quartile")

byincomesex <- cbind(Incomegroup, fitted1$predicted, fitted2$predicted)

kable(byincomesex, caption="Probability by Income Level & Sex", 
      col.names = c("Income Level", "Male", "Female"))
```

* By Education Level & Sex: predicted for those people with mean age, lower-middle income, valid licence, a car, and who doesn't live in Scotland.

```{r echo=F, warning=F, message=F, error=F}
# predicted probability by educ group & sex
fitted3 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=1, lowermiddle=1, 
                           highermiddle=0, high=0,
                           licence=1, degree=c(1,0), NumCar=1, Scotland=0))
fitted3$predicted <- predict(LPred, newdata = fitted3, type = 'response')
fitted3$predicted <- round(fitted3$predicted*100, digits=2)
fitted4 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=0, lowermiddle=1, 
                           highermiddle=0, high=0,
                           licence=1, degree=c(1,0), NumCar=1, Scotland=0))
fitted4$predicted <- predict(LPred, newdata = fitted4, type = 'response')
fitted4$predicted <- round(fitted4$predicted*100, digits=2)

Edugroup <- c("At least have a college degree", "Do not have a college degree")

byedusex <- cbind(Edugroup, fitted3$predicted, fitted4$predicted)

kable(byedusex, caption="Probability by Education Level & Sex", 
      col.names = c("Education Level", "Male", "Female"))
```

* By License Status & Sex: predicted for those people with mean age, lower-middle income, college degree, a car, and who doesn't live in Scotland.

```{r echo=F, warning=F, message=F, error=F}
# predicted probability by licence group & sex
fitted5 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=1, lowermiddle=1, 
                           highermiddle=0, high=0,
                           licence=c(1,0), degree=1, NumCar=1, Scotland=0))
fitted5$predicted <- predict(LPred, newdata = fitted5, type = 'response')
fitted5$predicted <- round(fitted5$predicted*100, digits=2)
fitted6 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=0, lowermiddle=1, 
                           highermiddle=0, high=0,
                           licence=c(1,0), degree=1, NumCar=1, Scotland=0))
fitted6$predicted <- predict(LPred, newdata = fitted6, type = 'response')
fitted6$predicted <- round(fitted6$predicted*100, digits=2)

ligroup <- c("Have driver's license", "Do not have driver's license")

bylisex <- cbind(Edugroup, fitted5$predicted, fitted6$predicted)

kable(bylisex, caption="Probabilities by Driver's License Status & Sex", 
      col.names = c("License Status", "Male", "Female"))
```

* By Number of Cars & Sex: predicted for those people with mean age, lower-middle income, college degree, valid licence, and who doesn't live in Scotland.

```{r echo=F, warning=F, message=F, error=F}
# predicted probability by NumCar & sex
fitted7 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=1, lowermiddle=1, 
                           highermiddle=0, high=0, licence=1, degree=1, 
                           NumCar=c(0,1,2,3), Scotland=0))
fitted7$predicted <- predict(LPred, newdata = fitted7, type = 'response')
fitted7$predicted <- round(fitted7$predicted*100, digits=2)
fitted8 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=0, lowermiddle=1, 
                           highermiddle=0, high=0, licence=1, degree=1, 
                           NumCar=c(0,1,2,3), Scotland=0))
fitted8$predicted <- predict(LPred, newdata = fitted8, type = 'response')
fitted8$predicted <- round(fitted8$predicted*100, digits=2)

bycarsex <- cbind(fitted7$NumCar, fitted7$predicted, fitted8$predicted)

kable(bycarsex, caption="Probabilities by Number of Cars & Sex", 
      col.names = c("Number of Cars", "Male", "Female"))
```

* By Region & Sex: predicted for those people with mean age, lower-middle income, college degree, valid licence, and a car.

```{r echo=F, warning=F, message=F, error=F}
# predicted probability by region & sex
fitted9 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=1, lowermiddle=1, 
                           highermiddle=0, high=0, licence=1, degree=1, 
                           NumCar=1, Scotland=c(1,0)))
fitted9$predicted <- predict(LPred, newdata = fitted9, type = 'response')
fitted9$predicted <- round(fitted9$predicted*100, digits=2)
fitted10 <- with(EVINTEREST,
                data.frame(RAGE=mean(RAGE), Male=0, lowermiddle=1, 
                           highermiddle=0, high=0, licence=1, degree=1, 
                           NumCar=1, Scotland=c(1,0)))
fitted10$predicted <- predict(LPred, newdata = fitted10, type = 'response')
fitted10$predicted <- round(fitted10$predicted*100, digits=2)

scotgroup <- c("In Scotland", "In other regions")

byscotsex <- cbind(scotgroup, fitted9$predicted, fitted10$predicted)

kable(byscotsex, caption="Probabilities by Region & Sex", 
      col.names = c("Region", "Male", "Female"))
```


Among all respondents, only 18.48% are interested. This, on the other hand, suggests the need to better understand the factors related to the interest in EVs, and this is what motivated our research too.

Above analysis shows that the variations among different groups are quite large. For instance, people having a college degree, on average, have a probability of 30.7% to be interested in EVs, while people without a degree only have a probability of 14.5%. This kind of variation (especially the one related to education level) is actually a good sign, suggesting that interest in EVs could be potentially increased. Promotion of EVs should give more attention to the needs and consumption patterns of low-interest groups. 


##Factors Putting Off/Encouraging Buying EVs

In order to investigate what would turn existing interest in EVs into actual consumption of EVs, we look at questions regarding factors that will put off or encourage buying EVs and summarize the results here.

###General factors

The graph below shows the major obstacles to buying an EV. 
The most popular issue is the recharging of the EVs, as `r round(mean(EVINTEREST$POrecharge)*100, digits=2)`% of respondents answered that they are concerned about it.
The second largest issue is the capacity of the batteries, which is crucial to the travel distance. `r round(mean(EVINTEREST$PObattery)*100, digits=2)`% of respondents are concerned about it, followed by the high costs of EVs (`r round(mean(EVINTEREST$POcost)*100, digits=2)`%).

```{r echo=F, warning=F, message=F, error=F, fig.cap="Factors putting off buying EVs"}
### Main Obstacles ###
obscat <- c('choice', 'knowledge', 'cost', 'battery', 'recharge', 
            'resale', 'safety', 'spec', 'technology')
obsmean <- c(mean(EVINTEREST$POchoice), mean(EVINTEREST$POknowledge),
             mean(EVINTEREST$POcost), mean(EVINTEREST$PObattery),
             mean(EVINTEREST$POrecharge), mean(EVINTEREST$POresale),
             mean(EVINTEREST$POsafety), mean(EVINTEREST$POcarspec),
             mean(EVINTEREST$POtech))
barplot(obsmean, names.arg=obscat, cex.names=0.6,
        ylab="% of respondents who choose the category")
```

Now we turn to the factors that may encourage EV consumption. The choices provided in the survey and their relative importance in the respondents' minds are shown in the figure xxx.

```{r echo=F, warning=F, message=F, error=F, results='asis', fig.cap="Factors encouraging buying EVs"}
ennames <- c('Cost', 'Battery: \n distance travelled \n on charge', 'Convenience \n of recharging', 'Resale/residual \n value', 'Safety \n features/record', 'Vehicle size, \n performance \n or aesthetics', 'If there was \n more choice \n available', 'Technology: \n reliable/proven', 'Environmentally \n friendly')
enmeans <- c(mean(EVINTEREST$ENcost), mean(EVINTEREST$ENbattery),
             mean(EVINTEREST$ENrecharge), mean(EVINTEREST$ENresale),
             mean(EVINTEREST$ENsafety), mean(EVINTEREST$ENcarspec),
             mean(EVINTEREST$ENchoice), mean(EVINTEREST$ENtech),
             mean(EVINTEREST$ENenv))
barplot(enmeans, names.arg=ennames, cex.names=0.35,
        ylab="% of respondents who choose the category")
```

Among the nine choices, the top four choices are: "Cost" with `r round(mean(EVINTEREST$ENcost)*100, digits=2)`% respondents choosing it, "Battery: distance travelled on charge" with `r round(mean(EVINTEREST$ENbattery)*100, digits=2)`%, "Convenience of recharging" with `r round(mean(EVINTEREST$ENrecharge)*100, digits=2)`%, and "Environmentally friendly" with `r round(mean(EVINTEREST$ENenv)*100, digits=2)`%. 

The facts above potentially reveal a public interest in EVs. If there were no interest at all, people would not have bothered to learn about EVs' battery capacity and recharging condition. In the section of policy recommendations, we will provide suggestions on how to take advantage of this interest.



### Cost-related factors

The survey also asks what aspects of the costs people are concerned about. 
As shown in the graph below, `r round(mean(EVINTEREST$POCpurchase)*100, digits=2)`% of respondents think that the purchasing costs would put them off buying an EV. The other major concerns are the maintenance costs (`r round(mean(EVINTEREST$POCmaintenance)*100, digits=2)`%) and the fuel/recharging costs including fuel tax (`r round(mean(EVINTEREST$POCfuel)*100, digits=2)`%). 

```{r echo=F, warning=F, message=F, error=F, fig.cap="Cost-related factors that put off buying EVs"}
cobscat <- c('purchase', 'fuel/charging', 'maintenance', 'resale', 'excise tax',
             'company tax', 'insurance')
cobsmean <- c(mean(EVINTEREST$POCpurchase), mean(EVINTEREST$POCfuel),
              mean(EVINTEREST$POCmaintenance), mean(EVINTEREST$POCresale),
              mean(EVINTEREST$POCextax), mean(EVINTEREST$POCcomptax),
              mean(EVINTEREST$POCinsurance))
barplot(cobsmean, names.arg=cobscat, cex.names=0.6,
        ylab="% of respondents who choose the category")
```

As for encouraging cost-related factors, the top three choices are the same, only with a different order. While the top choice is still the purchase cost (`r round(mean(EVINTEREST$ENCpurchase)*100, digits=2)`%), the second is fuel/recharging cost (`r round(mean(EVINTEREST$ENCfuel)*100, digits=2)`%) and the third is maintenance cost (`r round(mean(EVINTEREST$ENCmaintenance)*100, digits=2)`%).

```{r echo=F, warning=F, message=F, error=F, results='asis', fig.cap="Cost-related factors that encourage buying EVs"}
encostnames <-  c('purchase', 'fuel/recharging', 'maintenance', 'resale', 'excise tax',
             'company tax', 'insurance')
encostmeans <- c(mean(EVINTEREST$ENCpurchase), mean(EVINTEREST$ENCfuel),
             mean(EVINTEREST$ENCmaintenance), mean(EVINTEREST$ENCresale),
             mean(EVINTEREST$ENCextax), mean(EVINTEREST$ENCcomptac),
             mean(EVINTEREST$ENCinsurance))
barplot(encostmeans, names.arg=encostnames, cex.names=0.6,
        ylab="% of respondents who choose the category")
```

Admittedly, this question is rather vague, because it only gives us the information regarding what kind of cost matters most to consumers, but not how they think of the costs at current levels. However, the results clearly identify the costs that are most likely to be considered when making a car purchase, and these are where government can go in and provide financial incentives to consumers.


###Similar considerations for different groups
In an attempt to formulate policy recommendations that resemble differentiated marketing strategy, we compare the relative weight given to the factors by different groups. We find that in most cases, different groups share their relative weight given to different factors. However, we do find some differences that can be used in differentiated marketing strategy.

1. Young people's stronger environmental awareness is somewhat confirmed in our results. They actually rank environmentalism before battery capacity and recharging conditions. So are females, people without driver's licence, people without cars and people living in Scotland, compared with males, people with driver's licence, people with car(s) and people living elsewhere respectively. Therefore, although people are most encouraged by practical improvements, people can also be motivated by ideological affinity.

2. Higher-middle income people will be very encouraged by increased convenience of recharging. Reason for this might be that this group are mainly white collars who work in city centers and they might be concerned about the cost of charging at home.   

3. People with one car pay special attention to the potential of resale of EVs. Middle-income people (including people with lower-middle and higher-middle income) share this attention comparatively speaking. The majority of these groups of people might not be able to afford having one car. Therefore, they might want to make sure that they can esaily resale their EVs if EVs turned out to be a bad fit for them. This mindset is very common with the first generation who experience a new product. 

4. Lowering the insurance cost of EVs would be most effective with young people, people with lower-middle income and people in Scotland. Lowering the insurance cost is harder, because it depends on the pool insurance companies have and as only a minority of people possess EVs, the pool is small. Also, it is because maintaining and repairing EVs are relatively more expensive since they require specially-made components.


```{r echo=F, warning=F, message=F, error=F, results='asis', fig.cap="Relative weights to factors that encourage buying EVs among groups"}

#age group & factors encouraging buying
agemean <- c(mean(EVINTEREST$ENcost[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENbattery[EVINTEREST$agegroup==1]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENresale[EVINTEREST$agegroup==1]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$agegroup==1]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENtech[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENenv[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENcost[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENbattery[EVINTEREST$agegroup==2]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENresale[EVINTEREST$agegroup==2]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$agegroup==2]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENtech[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENenv[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENcost[EVINTEREST$agegroup==3]),
             mean(EVINTEREST$ENbattery[EVINTEREST$agegroup==3]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$agegroup==3]),
             mean(EVINTEREST$ENresale[EVINTEREST$agegroup==3]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$agegroup==3]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$agegroup==3]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$agegroup==3]),
             mean(EVINTEREST$ENtech[EVINTEREST$agegroup==3]),
             mean(EVINTEREST$ENenv[EVINTEREST$agegroup==3]))
ENfactor3 <- c("cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism")
Agegroupl <- c(1,1,1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,2,2,
               3,3,3,3,3,3,3,3,3)
meanagetable <- cbind(agemean, ENfactor3, Agegroupl)
ageEN <- ggplot(as.data.frame(meanagetable), aes(factor(ENfactor3), as.numeric(agemean), fill = as.factor(Agegroupl))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("young people", "middle-age people", "elder people"), 
                            values=c("dodgerblue", "dodgerblue2", "dodgerblue3")) +
        scale_x_discrete("  ",limits=c("cost", "battery", "recharge", "environmentalism", "technology", "design","choice", "safety", "resale")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#sex & factors encouraging buying
sexmean <- c(mean(EVINTEREST$ENcost[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENbattery[EVINTEREST$Male==1]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENresale[EVINTEREST$Male==1]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$Male==1]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENtech[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENenv[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENcost[EVINTEREST$Male==0]),
             mean(EVINTEREST$ENbattery[EVINTEREST$Male==0]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$Male==0]),
             mean(EVINTEREST$ENresale[EVINTEREST$Male==0]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$Male==0]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$Male==0]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$Male==0]),
             mean(EVINTEREST$ENtech[EVINTEREST$Male==0]),
             mean(EVINTEREST$ENenv[EVINTEREST$Male==0]))
ENfactor2 <- c("cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism")
sexgroupl <- c(1,1,1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,2,2)
meansextable <- cbind(sexmean, ENfactor2, sexgroupl)
sexEN <- ggplot(as.data.frame(meansextable), aes(factor(ENfactor2), as.numeric(sexmean), fill = as.factor(sexgroupl))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("male", "female"), 
                            values=c("dodgerblue", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("cost", "battery", "recharge", "environmentalism", "technology", "design","choice", "safety", "resale")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#income & factors encouraging buying
incmean <- c(mean(EVINTEREST$ENcost[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENbattery[EVINTEREST$inccat==1]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENresale[EVINTEREST$inccat==1]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$inccat==1]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENtech[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENenv[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENcost[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENbattery[EVINTEREST$inccat==2]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENresale[EVINTEREST$inccat==2]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$inccat==2]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENtech[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENenv[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENcost[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENbattery[EVINTEREST$inccat==3]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENresale[EVINTEREST$inccat==3]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$inccat==3]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENtech[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENenv[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENcost[EVINTEREST$inccat==4]),
             mean(EVINTEREST$ENbattery[EVINTEREST$inccat==4]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$inccat==4]),
             mean(EVINTEREST$ENresale[EVINTEREST$inccat==4]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$inccat==4]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$inccat==4]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$inccat==4]),
             mean(EVINTEREST$ENtech[EVINTEREST$inccat==4]),
             mean(EVINTEREST$ENenv[EVINTEREST$inccat==4]))
ENfactor4 <- c("cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism")
incgroupl <- c(1,1,1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,2,2,
               3,3,3,3,3,3,3,3,3,
               4,4,4,4,4,4,4,4,4)
meaninctable <- cbind(incmean, ENfactor4, incgroupl)
incomeEN <- ggplot(as.data.frame(meaninctable), aes(factor(ENfactor4), as.numeric(incmean), fill = as.factor(incgroupl))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("low-income \n people", "lower-middle-income \n people", "higher-middle-income \n people", "high-income \n people"), 
                            values=c("dodgerblue", "dodgerblue2", "dodgerblue3", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("cost", "battery", "recharge", "environmentalism", "technology", "design","choice", "safety", "resale")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#college & factors encouraging buying
collegemean <- c(mean(EVINTEREST$ENcost[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENbattery[EVINTEREST$degree==1]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENresale[EVINTEREST$degree==1]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$degree==1]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENtech[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENenv[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENcost[EVINTEREST$degree==0]),
             mean(EVINTEREST$ENbattery[EVINTEREST$degree==0]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$degree==0]),
             mean(EVINTEREST$ENresale[EVINTEREST$degree==0]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$degree==0]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$degree==0]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$degree==0]),
             mean(EVINTEREST$ENtech[EVINTEREST$degree==0]),
             mean(EVINTEREST$ENenv[EVINTEREST$degree==0]))
ENfactor2 <- c("cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism")
sexgroupl <- c(1,1,1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,2,2)
collegemeantable <- cbind(collegemean, ENfactor2, sexgroupl)
collegeEN <- ggplot(as.data.frame(collegemeantable), aes(factor(ENfactor2), as.numeric(collegemean), fill = as.factor(sexgroupl))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("People with \n college degree", "people without \n college degree"), 
                            values=c("dodgerblue", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("cost", "battery", "recharge", "environmentalism", "technology", "design","choice", "safety", "resale")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#driver's licence & factors encouraging buying
licencemean <- c(mean(EVINTEREST$ENcost[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENbattery[EVINTEREST$licence==1]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENresale[EVINTEREST$licence==1]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$licence==1]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENtech[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENenv[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENcost[EVINTEREST$licence==0]),
             mean(EVINTEREST$ENbattery[EVINTEREST$licence==0]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$licence==0]),
             mean(EVINTEREST$ENresale[EVINTEREST$licence==0]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$licence==0]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$licence==0]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$licence==0]),
             mean(EVINTEREST$ENtech[EVINTEREST$licence==0]),
             mean(EVINTEREST$ENenv[EVINTEREST$licence==0]))
ENfactor2 <- c("cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism")
sexgroupl <- c(1,1,1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,2,2)
licencemeantable <- cbind(licencemean, ENfactor2, sexgroupl)
licenceEN <- ggplot(as.data.frame(licencemeantable), aes(factor(ENfactor2), as.numeric(licencemean), fill = as.factor(sexgroupl))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("People with \n driver's licence", "people without \n driver's licence"), 
                            values=c("dodgerblue", "dodgerblue4")) +
        scale_x_discrete("  ", limits=c("cost", "battery", "recharge", "environmentalism", "technology", "design","choice", "safety", "resale")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#number of cars & factors encouraging buying
carnomean <- c(mean(EVINTEREST$ENcost[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENbattery[EVINTEREST$NumCar==0]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENresale[EVINTEREST$NumCar==0]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$NumCar==0]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENtech[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENenv[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENcost[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENbattery[EVINTEREST$NumCar==1]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENresale[EVINTEREST$NumCar==1]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$NumCar==1]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENtech[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENenv[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENcost[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENbattery[EVINTEREST$NumCar==2]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENresale[EVINTEREST$NumCar==2]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$NumCar==2]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENtech[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENenv[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENcost[EVINTEREST$NumCar==3]),
             mean(EVINTEREST$ENbattery[EVINTEREST$NumCar==3]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$NumCar==3]),
             mean(EVINTEREST$ENresale[EVINTEREST$NumCar==3]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$NumCar==3]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$NumCar==3]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$NumCar==3]),
             mean(EVINTEREST$ENtech[EVINTEREST$NumCar==3]),
             mean(EVINTEREST$ENenv[EVINTEREST$NumCar==3]))
ENfactor4 <- c("cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism")
incgroupl <- c(1,1,1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,2,2,
               3,3,3,3,3,3,3,3,3,
               4,4,4,4,4,4,4,4,4)
carnomeantable <- cbind(carnomean, ENfactor4, incgroupl)
carnoEN <- ggplot(as.data.frame(carnomeantable), aes(factor(ENfactor4), as.numeric(carnomean), fill = as.factor(incgroupl))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("no car", "1 car", "2 cars", "3 cars \n or more"), 
                            values=c("dodgerblue", "dodgerblue2", "dodgerblue3", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("cost", "battery", "recharge", "environmentalism", "technology", "design","choice", "safety", "resale")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#in scotland & factors encouraging buying
scotmean <- c(mean(EVINTEREST$ENcost[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENbattery[EVINTEREST$Scotland==1]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENresale[EVINTEREST$Scotland==1]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$Scotland==1]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENtech[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENenv[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENcost[EVINTEREST$Scotland==0]),
             mean(EVINTEREST$ENbattery[EVINTEREST$Scotland==0]), 
             mean(EVINTEREST$ENrecharge[EVINTEREST$Scotland==0]),
             mean(EVINTEREST$ENresale[EVINTEREST$Scotland==0]), 
             mean(EVINTEREST$ENsafety[EVINTEREST$Scotland==0]),
             mean(EVINTEREST$ENcarspec[EVINTEREST$Scotland==0]), 
             mean(EVINTEREST$ENchoice[EVINTEREST$Scotland==0]),
             mean(EVINTEREST$ENtech[EVINTEREST$Scotland==0]),
             mean(EVINTEREST$ENenv[EVINTEREST$Scotland==0]))
ENfactor2 <- c("cost","battery","recharge","resale","safety","design","choice","technology","environmentalism","cost","battery","recharge","resale","safety","design","choice","technology","environmentalism")
sexgroupl <- c(1,1,1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,2,2)
scotmeantable <- cbind(scotmean, ENfactor2, sexgroupl)
scotEN <- ggplot(as.data.frame(scotmeantable), aes(factor(ENfactor2), as.numeric(scotmean), fill = as.factor(sexgroupl))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("people in Scotland", "people elsewhere"), 
                            values=c("dodgerblue", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("cost", "battery", "recharge", "environmentalism", "technology", "design","choice", "safety", "resale")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#put them in one
grid.arrange(ageEN, sexEN, incomeEN, collegeEN, licenceEN,carnoEN,scotEN, ncol=2, nrow=4)
```

```{r echo=F, warning=F, message=F, error=F, results='asis', fig.cap="Relative weight to cost-related factors that encourage buying EVs among groups"}
#age group & factors encouraging buying
agemeanc <- c(mean(EVINTEREST$ENCpurchase[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$agegroup==1]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENCresale[EVINTEREST$agegroup==1]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$agegroup==1]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$agegroup==1]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$agegroup==2]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENCresale[EVINTEREST$agegroup==2]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$agegroup==2]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$agegroup==2]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$agegroup==3]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$agegroup==3]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$agegroup==3]),
             mean(EVINTEREST$ENCresale[EVINTEREST$agegroup==3]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$agegroup==3]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$agegroup==3]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$agegroup==3]))
ENCfactor3 <- c("purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance", "purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance", "purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance")
Agegrouplc <- c(1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,
               3,3,3,3,3,3,3)
meancagetable <- cbind(agemeanc, ENCfactor3, Agegrouplc)
ageENC <- ggplot(as.data.frame(meancagetable), aes(factor(ENCfactor3), as.numeric(agemeanc), fill = as.factor(Agegrouplc))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("young people", "middle-age people", "elder people"), 
                            values=c("dodgerblue", "dodgerblue2", "dodgerblue3")) +
        scale_x_discrete("  ",limits=c("purchase", "fuel/recharging", "maintenance", "insurance", "excise tax", "resale","company tax")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#sex & factors encouraging buying
sexmeanc <- c(mean(EVINTEREST$ENCpurchase[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$Male==1]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENCresale[EVINTEREST$Male==1]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$Male==1]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$Male==1]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$Male==0]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$Male==0]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$Male==0]),
             mean(EVINTEREST$ENCresale[EVINTEREST$Male==0]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$Male==0]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$Male==0]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$Male==0]))
ENCfactor2 <- c("purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance", "purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance")
sexgrouplc <- c(1,1,1,1,1,1,1,
               2,2,2,2,2,2,2)
meancsextable <- cbind(sexmeanc, ENCfactor2, sexgrouplc)
sexENC <- ggplot(as.data.frame(meancsextable), aes(factor(ENCfactor2), as.numeric(sexmeanc), fill = as.factor(sexgrouplc))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("male", "female"), 
                            values=c("dodgerblue", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("purchase", "fuel/recharging", "maintenance", "insurance", "excise tax", "resale","company tax")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#income & factors encouraging buying
incmeanc <- c(mean(EVINTEREST$ENCpurchase[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$inccat==1]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENCresale[EVINTEREST$inccat==1]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$inccat==1]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$inccat==1]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$inccat==2]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENCresale[EVINTEREST$inccat==2]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$inccat==2]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$inccat==2]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$inccat==3]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENCresale[EVINTEREST$inccat==3]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$inccat==3]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$inccat==3]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$inccat==4]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$inccat==4]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$inccat==4]),
             mean(EVINTEREST$ENCresale[EVINTEREST$inccat==4]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$inccat==4]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$inccat==4]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$inccat==4]))
ENCfactor4 <- c("purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance","purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance","purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance","purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance")
incgrouplc <- c(1,1,1,1,1,1,1,
               2,2,2,2,2,2,2,
               3,3,3,3,3,3,3,
               4,4,4,4,4,4,4)
meancinctable <- cbind(incmeanc, ENCfactor4, incgrouplc)
incomeENC <- ggplot(as.data.frame(meancinctable), aes(factor(ENCfactor4), as.numeric(incmeanc), fill = as.factor(incgrouplc))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("low-income \n people", "lower-middle-income \n people", "higher-middle-income \n people", "high-income \n people"), 
                            values=c("dodgerblue", "dodgerblue2", "dodgerblue3", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("purchase", "fuel/recharging", "maintenance", "insurance", "excise tax", "resale","company tax")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#college & factors encouraging buying
collegemeanc <- c(mean(EVINTEREST$ENCpurchase[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$degree==1]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENCresale[EVINTEREST$degree==1]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$degree==1]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$degree==1]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$degree==0]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$degree==0]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$degree==0]),
             mean(EVINTEREST$ENCresale[EVINTEREST$degree==0]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$degree==0]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$degree==0]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$degree==0]))
ENCfactor2 <- c("purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance","purchase","maintenance","fuel/recharging","resale","excise tax","company tax","insurance")
collegemeanctable <- cbind(collegemeanc, ENCfactor2, sexgrouplc)
collegeENC <- ggplot(as.data.frame(collegemeanctable), aes(factor(ENCfactor2), as.numeric(collegemeanc), fill = as.factor(sexgrouplc))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("People with \n college degree", "people without \n college degree"), 
                            values=c("dodgerblue", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("purchase", "fuel/recharging", "maintenance", "insurance", "excise tax", "resale","company tax")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#driver's licence & factors encouraging buying
licencemeanc <- c(mean(EVINTEREST$ENCpurchase[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$licence==1]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENCresale[EVINTEREST$licence==1]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$licence==1]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$licence==1]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$licence==0]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$licence==0]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$licence==0]),
             mean(EVINTEREST$ENCresale[EVINTEREST$licence==0]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$licence==0]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$licence==0]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$licence==0]))
licencemeanctable <- cbind(licencemeanc, ENCfactor2, sexgrouplc)
licenceENC <- ggplot(as.data.frame(licencemeanctable), aes(factor(ENCfactor2), as.numeric(licencemeanc), fill = as.factor(sexgrouplc))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("People with \n driver's licence", "people without \n driver's licence"), 
                            values=c("dodgerblue", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("purchase", "fuel/recharging", "maintenance", "insurance", "excise tax", "resale","company tax")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#number of cars & factors encouraging buying
carnomeanc <- c(mean(EVINTEREST$ENCpurchase[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$NumCar==0]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENCresale[EVINTEREST$NumCar==0]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$NumCar==0]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$NumCar==0]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$NumCar==1]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENCresale[EVINTEREST$NumCar==1]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$NumCar==1]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$NumCar==1]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$NumCar==2]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENCresale[EVINTEREST$NumCar==2]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$NumCar==2]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$NumCar==2]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$NumCar==3]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$NumCar==3]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$NumCar==3]),
             mean(EVINTEREST$ENCresale[EVINTEREST$NumCar==3]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$NumCar==3]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$NumCar==3]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$NumCar==3]))
carnomeanctable <- cbind(carnomeanc, ENCfactor4, incgrouplc)
carnoENC <- ggplot(as.data.frame(carnomeanctable), aes(factor(ENCfactor4), as.numeric(carnomeanc), fill = as.factor(incgrouplc))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("no car", "1 car", "2 cars", "3 cars \n or more"), 
                            values=c("dodgerblue", "dodgerblue2", "dodgerblue3", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("purchase", "fuel/recharging", "maintenance", "insurance", "excise tax", "resale","company tax")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#in scotland & factors encouraging buying
scotmeanc <- c(mean(EVINTEREST$ENCpurchase[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$Scotland==1]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENCresale[EVINTEREST$Scotland==1]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$Scotland==1]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$Scotland==1]),
             mean(EVINTEREST$ENCpurchase[EVINTEREST$Scotland==0]),
             mean(EVINTEREST$ENCmaintenance[EVINTEREST$Scotland==0]), 
             mean(EVINTEREST$ENCfuel[EVINTEREST$Scotland==0]),
             mean(EVINTEREST$ENCresale[EVINTEREST$Scotland==0]), 
             mean(EVINTEREST$ENCextax[EVINTEREST$Scotland==0]),
             mean(EVINTEREST$ENCcomptac[EVINTEREST$Scotland==0]), 
             mean(EVINTEREST$ENCinsurance[EVINTEREST$Scotland==0]))
scotmeanctable <- cbind(scotmeanc, ENCfactor2, sexgrouplc)
scotENC <- ggplot(as.data.frame(scotmeanctable), aes(factor(ENCfactor2), as.numeric(scotmeanc), fill = as.factor(sexgrouplc))) + 
        geom_bar(stat="identity", position = "dodge") +
        scale_fill_manual(labels=c("people in Scotland", "people elsewhere"), 
                            values=c("dodgerblue", "dodgerblue4")) +
        scale_x_discrete("  ",limits=c("purchase", "fuel/recharging", "maintenance", "insurance", "excise tax", "resale","company tax")) +
        labs(fill="  ") +
        theme(panel.grid =element_blank())+
        scale_y_continuous("relative weight", labels=NULL)

#put them in one
grid.arrange(ageENC, sexENC, incomeENC, collegeENC, licenceENC,carnoENC,scotENC, ncol=2, nrow=4)
```


# Recommendations
Based on analysis in the previous section, we make the following policy recommendations on how to promote EVs in the UK.

1. Information campaign targeted on low-interest groups, in addition to general information campaign, is needed. Admitted, the general interest in EVs is still rather low, as only about 18% of the respondents show interest. However, we find great gaps among different groups and believe that these closing these gaps will great increase the level of interest. Females and people without a college degree are two groups in question. Information campaign on channels that are popular with these groups and catering the campaign to their tastes could be helpful in promoting EVs.

2. Removing obstacles by investing in R&D related to battery and recharging facilities must be continued. EVs, in many ways, are very different from traditional cars, and thus might even alter people's driving and other habits. Therefore, constantly improving battery and recharging facilities to reduce the changes consumers need to make will encourage more people to accept EVs. 

3. Putting recharging facilities in place should be a priority, as most respondents are put off by the inconvenience of recharging. There needs to be a long-term plan for this, since charging EVs takes much time and making sure that recharges needs are met in time can be hard if the number of EVs increase greatly in the future.

4. Providing financial incentives, especially the ones regarding lowering purchase prices, is necessary. There are many ways to desgin financial incentives and lower EV prices, and different policies can have very different results.Generally speaking, the policies that immediately reduce the price (as constrast to refund) are most effective [@givinggreen].

5. Advertising the economic benefits of EVs could be encouraging. Suprisingly, energy cost ranks the third among nine cost-related factors that put off buying EVs, since EVs are cheaper than conventional vehicles in terms of energy cost [@Herron2015web]. Highlighting this information may change some people's minds.

6. Differentiated marketing strategies could be adopted in possible. They might help catalyze the process of turning interest into actual consumption of EVs.

Admittedly, there are some aspects that are beyond the capacity of government. For example, higher maintenance and insurance costs are largely the results of market. Relatively limited choices of models of EVs are probably due to companies' market projections as well. However, we believe that there are still much that can be done by the government to promote EVs, although there is still long way to go before EVs replace conventional cars too.



#Limitations
One limitation is due to the design of the survey, which did not exclude respondents who are not interested in buying cars in general. Therefore, variables, including having driver's license and number of cars available, need to be interpreted with great caution. The low interest shown in groups without driver's license or cars might not be caused by their lack of interest in EVs, but by their lack of interest in cars.

Another limitation is that $R^2$ of the model is only 0.12, meaning that these variables only explain 12% of the variations in the probability of having an interest in EVs. Partly, this is because of a lack of available information, as it is impossible to survey everything. Partly, attitudes are just not easy to explain, because they could be influenced by countless factors, sometimes as trivial as an image or some careless words. Nevertheless, we believe that there are patterns and these patterns are what we should better understand if EVs are to be further promoted.

# Reference

---
notice: | 
  @CiteR,@R-captioner,@R-dplyr,@R-foreign,@R-ggplot2,@R-googleVis,@R-knitr,@R-markdown,@R-repmis,@R-rms,@R-stargazer,@R-Zelig
...
