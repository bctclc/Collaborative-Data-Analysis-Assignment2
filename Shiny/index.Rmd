---
title: "Expanding electric vehicle sales in the UK"
author: "Claire Chang Liu & Noriko Magara"
output: html_document
runtime: shiny
---

```{r results='hide',echo=F, warning=F, message=F, error=F}
library(knitr)
library(googleVis)

load("EVdata1.rda")
```

What types of people are interest in electric vehicles? Who are the target population that car manufacturers should focus? What kind of government policies could promote EV adoption?
[A recent survey by the UK government](https://discover.ukdataservice.ac.uk/Catalogue/?sn=7571&type=Data%20catalogue) has revealed the potential EV buyers and their concerns. 


### People who are interested in EVs

According to the survey, **`r round(mean(EVINTEREST$EVinterest)*100, digits=2)`%** of people in the UK have interest in EVs. But different groups of people have different levels of interest. Here is a breakdown.

```{r, echo=FALSE, warning=F, message=F, error=F, results='asis'}
sgrp2 <- c("Male", "Female", "Low income", "Low-mid income", "Hige-mid income",
           "High income", "College degree", "No college degree", "Driver's licence", 
           "No driver's licence", "Have children", "No children")
meangrp <- c(mean(EVINTEREST$EVinterest[EVINTEREST$Male==1]),
             mean(EVINTEREST$EVinterest[EVINTEREST$Male==0]),
             mean(EVINTEREST$EVinterest[EVINTEREST$inccat==1]),
             mean(EVINTEREST$EVinterest[EVINTEREST$inccat==2]),
             mean(EVINTEREST$EVinterest[EVINTEREST$inccat==3]),
             mean(EVINTEREST$EVinterest[EVINTEREST$inccat==4]),
             mean(EVINTEREST$EVinterest[EVINTEREST$degree==1]),
             mean(EVINTEREST$EVinterest[EVINTEREST$degree==0]),
             mean(EVINTEREST$EVinterest[EVINTEREST$licence==1]),
             mean(EVINTEREST$EVinterest[EVINTEREST$licence==0]),
             mean(EVINTEREST$EVinterest[EVINTEREST$havechildren==1]),
             mean(EVINTEREST$EVinterest[EVINTEREST$havechildren==0]))
cbd_grp2 <- data.frame(group=sgrp2, Percent=round(meangrp*100, digits = 2))

B <- gvisBarChart(cbd_grp2, options=list(width=800, height=300))
print(B, tag = 'chart')
```

People living in different places have different levels of interest, and, the the geographical distribution differ by groups.
The map below shows the levels of people's interest by Government Office Regions. 
You can see different patterns by choosing a group from the dropdown list below.

```{r, echo=FALSE}
inputPanel(
  selectInput("var",
              label = "Choose a group to display",
              choices = c("Whole Population", 
                          "Females",
                          "Males",
                          "Young People",
                          "Middle-Age People",
                          "Old-Age People",
                          "Low-Income People",
                          "Lower-Middle Income People",
                          "Higher-Middle Income People",
                          "High-Income People",
                          "College Graduates",
                          "Non-College Graduates",
                          "Having Driver's Licence",
                          "Not Having Driver's Licence",
                          "People with No Car",
                          "People with One Car",
                          "People with Two Cars",
                          "People with Three or More Cars"),
              selected = "Whole Population")
  
)

renderText({
    
    paste("% of ", input$var, "who have interested in EVs by regions")
    
  })

renderImage({
    
    selectedgroup <- switch(input$var, 
                            "Whole Population" = 'map1.png', 
                            "Females" = 'map2.png',
                            "Males" = 'map3.png',
                            "Young People" = 'map4.png',
                            "Middle-Age People" = 'map5.png',
                            "Old-Age People" = 'map6.png',
                            "Low-Income People" = 'map7.png',
                            "Lower-Middle Income People" = 'map8.png',
                            "Higher-Middle Income People" = 'map9.png',
                            "High-Income People" = 'map10.png',
                            "College Graduates" = 'map11.png',
                            "Non-College Graduates" = 'map12.png',
                            "Having Driver's Licence" = 'map13.png',
                            "Not Having Driver's Licence" = 'map14.png',
                            "People with No Car" = 'map15.png',
                            "People with One Car" = 'map16.png',
                            "People with Two Cars" = 'map17.png',
                            "People with Three or More Cars" = 'map18.png')
    
    filename <- normalizePath(file.path('./ExportedMaps', selectedgroup))
    
    list(src = filename,
         alt = paste("Image number"))
    
                  }, deleteFile = FALSE)
br()
br()
br()

```


### Factors that encourage people to buy an EV

Now we know who are interested in electric vehicles, but how to turn their interest into consumption? 
The two charts below will show you what matters and matters most to different groups. 
You can choose a grouping creterion from the dropdown list below.

```{r, echo=FALSE}
inputPanel(
  selectInput("factor",
              label = "Choose a grouping creterion",
              choices = c("age",
                          "sex",
                          "income level",
                          "education level",
                          "driver's licence status",
                          "number of cars owned",
                          "region"),
              selected = "age")
  
)
```

#### General factors
The graph below shows proportions of people who choose each category as a factor that encourages him/her buying an EV. 
The choices are: costs, battery capacity (e.g. distance travelled on charge), convenience of recharging, environmentalism, technology (if it's reliable/proven), design, availability of choice, safety, and resale value.

```{r, echo=FALSE}

renderImage({
    
    selectedgroup2 <- switch(input$factor, 
                           "age"="factor_age.png",
                          "sex"="factor_sex.png",
                          "income level"="factor_income.png",
                          "education level"="factor_college.png",
                          "driver's licence status"="factor_licence.png",
                          "number of cars owned"="factor_carnumber.png",
                          "region"="factor_scotland.png")
    
    filename2 <- normalizePath(file.path('./ExportedMaps', selectedgroup2))
    
    list(src = filename2,
         alt = paste("Image number"))
    
                  }, deleteFile = FALSE)
br()
br()
br()
br()
br()
br()
br()
br()
br()
br()
```

#### Cost-related factors
The next graph shows detailed breakdown of costs - what kind of cost-related factors encourage people? 
The choices are: purchase costs, fuel/recharging costs (including fuel tax), maintenance costs, insurance costs, vehicle excise tax, resale value, and company car tax.

```{r, echo=FALSE}

renderImage({
    
    selectedgroup3 <- switch(input$factor, 
                           "age"="cost_age.png",
                          "sex"="cost_sex.png",
                          "income level"="cost_income.png",
                          "education level"="cost_college.png",
                          "driver's licence status"="cost_licence.png",
                          "number of cars owned"="cost_carnumber.png",
                          "region"="cost_scotland.png")
    
    filename3 <- normalizePath(file.path('./ExportedMaps', selectedgroup3))
    
    list(src = filename3,
         alt = paste("Image number"))
    
                  }, deleteFile = FALSE)

br()
br()
br()
br()
br()
br()
br()
br()
br()
br()
```

### Some reccomendations

Statistical analyses suggest that **age**, **sex**, **income**, **college degree**, **drivers licence**, **Number of cars**, **living in Scotland or not** are significant predictor of whether a person is interested in buying an EV.

Namely, **younger** people are more likely to be interested in EVs than older people, and likewise, **male** are more likely than females, **high income** people are more likely than low income people, people who have a **college degree** and **drivers licence** are more likely compared to people who don't have ones, people who own **more cars** are more likely, and people living in **Scotland** are *less* likely than people living in other parts of the UK.

Considering the encouraging factors chosen by those more-interested groups, a couple of possible strategies to promote EVs are derived:

- **Information campaign**
    + For people who already have interests in EVs, providing detailed information such as advangate in energy costs and environmental responsibility would be helpful to turn their interest to actual purchase.
    + For people who are not interested in EVs yet, more general information campaigns that would make them make interested would be needed.
- **Investment in R&D**
    + As battery capacity (driving distance) is one of the major factors that encourage people buying an EV, thechnological advancement is definitely necessary. In order to achieve this, more investment on R&D are desirad.  
    + Improving the efficiency of recharging facilities (chargers that take less time to charge) is also something that requires R&D efforts. 
- **Putting recharing facilities in place**
    + Convenience of recharging is also a major encouraging factor. Although increasing the number of charging stations may be a long-term plan, it is essential to wide-spread EV adoption.
- **Financial incentives**
    + Since many people are concerned about costs, especially purchase costs, policies that immediately reduce purchase price can increase the EV adoption.
- **Differentiated marketing strategies**
    + We know what group of people are interested or not very interested in purchasing an EV, and by what factors they would be encouraged. So, it is possible to differentiate these strategies depending on the target population.


