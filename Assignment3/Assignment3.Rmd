---
title: "Determinants of Interest in the EVs in the UK"
author: "Claire Chang Liu & Noriko Magara"
date: "Nov. 13th, 2015"
output:
  pdf_document: 
    fig_caption: yes
    number_sections: yes  
bibliography: Package_Citation.bib
---

This paper examine the determinants of interest in the Electric Vehicles in the UK. 
First, we will describe the process of data gathering. 
Then we descriptively analyze the dependent variable and independent variables. 
Last part will be a preliminary analysis using logistic regression models.

```{r results='hide',echo=F, warning=F, message=F, error=F}
# set working directry (# change this line)
setwd("C:/Users/noriko/Desktop/Collaborative-Data-Analysis-Assignment2/Assignment3")

library(stargazer)
library(knitr)
library(Zelig)
library(rms)
library(captioner)
library(foreign)
library(dplyr)
figcap <- captioner(prefix = "Figure", auto_space = TRUE, levels = 1, type = NULL)
tablecap <-captioner(prefix = "Table", auto_space = TRUE, levels = 1, type = NULL)
```

# Data Gathering
This analysis is based on survey data in the UK called ["Opinions and Lifestyle Survey, Electric Vehicles Module, February 2014 and February 2015"](https://discover.ukdataservice.ac.uk/Catalogue/?sn=7571&type=Data%20catalogue) [@UKDATA]. 
Note that [registration](http://ukdataservice.ac.uk/get-data/how-to-access/registration) is required to download the dataset from the UK Data Service website above.
After logging in and agreeing with the terms of conditions, the datasets are available for download in STATA or other format.
The registration process may take a few days. 
However, other documents (e.g. questionnaire, brief summary) are available at the link above without registration.
This module comes with two datasets: survey results from 2014 and 2015. 
For our study, we use both survey years by combining both datasets together. 

```{r echo=F, warning=F, message=F, error=F}
source("data_cleanup.R")
```

# Descriptive Analysis
## Variables
The list of variables are shown in the table below.

|Name        |Type       |Description                                                       |
|------------|-----------|------------------------------------------------------------------|
|EVinterest  |dummy      |Whether the respondent is interested in EVs or not                |
|RAGE        |continuous |Respondent's age                                                  |
|Male        |dummy      |Respondent's sex                                                  |
|inccat      |categorical|Respondent's income in 4 categories (low, low-mid, high-mid, high)|
|degree      |dummy      |Whether the respondent is a college graduate or not               |
|licence     |dummy      |Whether the respondent has a valid drivers licence or not         |
|NumCar      |continuous |Number of cars in the respondent's household                      |
|DVHsize     |continuous |Respondent's household size                                       |
|havechildren|dummy      |Whether the Respondent has children or not                        |
|Scotland    |dummy      |Whether the Respondent lives in Scotland or not                   |

## Summary statistics
* **EVinterest**: `r round(mean(EVINTEREST$EVinterest)*100, digits=2)` % of respondents are interested in EVs

* **RAGE**: Mean=`r round(mean(EVINTEREST$RAGE), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$RAGE), digits=2)`

```{r echo=F, warning=F, message=F, error=F, fig.cap=figcap("age", "Distribution of respondent's age")}
hist(EVINTEREST$RAGE,
     main="Age Distribution", xlab="Age", ylab="Frequency", 
     xlim=c(10,100))
axis(side=1, at=seq(0,100, 10))
```

* **Male**: `r round(mean(EVINTEREST$Male)*100, digits=2)` % of respondents are male

* **inccat**: distribution is shown in the graph below.

```{r echo=F, warning=F, message=F, error=F, fig.cap=figcap("inccat", "Distribution of respondent's income")}
inctable <-table(EVINTEREST$inccat)
barplot(inctable, main="Income Distribtion",ylab="Frequnecy",
        names.arg=c("Low", "Low-Mid", "High-Mid", "High"))
mtext(side=1, "Gross Annual Income", line=2)
mtext(side=1, "(Low:~14,559 / Low-Mid:14,560~20,799 / High-Mid:20,800~25,999 / High: 26,000+)", line=3)
```

* **degree**: `r round(mean(EVINTEREST$degree)*100, digits=2)` % of respondents have college degree

* **licence**: `r round(mean(EVINTEREST$licence)*100, digits=2)` % of respondents have valid drivers licence

* **NumCar**: Mean=`r round(mean(EVINTEREST$NumCar), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$NumCar), digits=2)`

```{r echo=F, warning=F, message=F, error=F, fig.cap=figcap("NumCar", "Distribution of number of cars")}
cartable <-table(EVINTEREST$NumCar)
barplot(cartable, main="Number of Cars in Each Household", 
     xlab="Number of Cars", ylab="Frequency")
```

* **DVHsize**: Mean=`r round(mean(EVINTEREST$DVHsize), digits=2)`, Standard deviation=`r round(sd(EVINTEREST$DVHsize), digits=2)`

```{r echo=F, warning=F, message=F, error=F, fig.cap=figcap("DVHsize", "Distribution of household size")}
Hsizetable <- table(EVINTEREST$DVHsize)
barplot(Hsizetable, main="Household size", 
        xlab="Household size", ylab="Frequency")
```

* **havechildren**: `r round(mean(EVINTEREST$havechildren)*100, digits=2)` % of respondents have children

* **Scotland**: `r round(mean(EVINTEREST$Scotland)*100, digits=2)` % of respondents lives in Scotland


#Logistic Regression
##Modelling
In this section presents our efforts to answer the question, "Who are more/less likely to be interested in the EVs". Since the dependent variable is a binary variable, i.e. respondents having an interest in the EVs or not, we adopt logistic regression models here.

Nine independent variables are categorized into four groups. Socio-economic variables include age, sex, gross annual income level, and education level. The second group includes having driver's license or not, and the number of cars available to the household, which to some extent describe the respondents' potential to buy a new car.The third one is household-level variables, including household size and whether or not having depedent children. The last one is region. (The UK has 11 regions in total. However, our preliminary analysis suggests that, using London as the baseline, only Scotland is significantly different. Therefore, we only include "Scotland" in the regression.)

We only include socio-economic variables in our base model (regression 1) and add in a new group of independent variables each time. The results are as following:

```{r echo=F, warning=F, message=F, error=F}
# Estimate model-1 (AGE & SEX & INCOME & Education)
L1 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree, 
           EVINTEREST)

# Estimate model-2 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars)
L2 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree + licence + NumCar, EVINTEREST)

# Estimate model-3 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars % Number of Children)
L3 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree + licence + NumCar + DVHsize + havechildren,
          EVINTEREST)

# Estimate model-4 (AGE & SEX & INCOME & Education & LICENCE & Number of Cars & Number of Children & Scotland)
L4 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree + licence + NumCar + DVHsize + havechildren + Scotland,
          EVINTEREST)
```

```{r echo=F, warning=F, message=F, error=F, results='asis'}
labels <- c('Age', 'Male', 'Income: low-middle', 'Income: high-middle', 'Income: high', 
            'College degree', 'Drivers licence', 'Number of cars', "Size of household", 'Having dependent children', 'Scotland', '(Intercept)') 
stargazer::stargazer(L1, L2, L3, L4,  type="latex", header=F, covariate.labels = labels,
                     digits = 2, title =tablecap("step-wise", "Step-wise Modelling"))
```

As the table above shows, all models are significant at 99% level. Except for the two variables, size of household and having dependent children or not, all other variables are statistically signifcant as well. The fact that household-related variables are effective predictors at macro level, but not at micro level, may suggest a neighborhood effect, but it is beyond the scope of this paper.

Based on this analysis, we leave out the two household-related variables and use the following formula.

$$Prob(Interested-in-EVs)= \beta_{0}+\beta_{1}Age+\beta_{2}Male+\beta_{3}Lowmid$$

$$+\beta_{4}Highmid+\beta_{5}High+\beta_{6}College+\beta_{7}License+\beta_{8}Numcar+\beta_{9}Scotland$$

```{r echo=F, warning=F, message=F, error=F, results='asis'}
finallabels <- c('Age', 'Male', 'Income: low-middle', 'Income: high-middle', 'Income: high', 
            'College degree', 'Drivers licence', 'Number of cars', 'Scotland', '(Intercept)') 
L5 <- lrm(EVinterest ~ RAGE + Male + lowermiddle + highermiddle +high + degree 
          + licence + NumCar + Scotland,
          EVINTEREST)
stargazer::stargazer(L5, type="latex", header=F, covariate.labels = finallabels,
                     digits = 2, title =tablecap("final-model", "Interests in EVs"))
```

The model is statistically significant at 99% level and five out of the seven variables are significant at 95% level. On average, males are more likely to be interested in electric vehicles. Having a college degree or driver's license also increases the likelihood of being interested. The number of cars is positively relative to the likelihood, suggesting that people who already have the "basics" are more likely to consider electric vehicles. However, being in Scotland reduces this likelihood. 

The less significant variables are age and income level. Age is negatively relative to the likelihood of being interested, meaning that younger people are more likely to have an interest in electric vehicles. Interestingly, income level seems not to matter much. Using the lowest quartile group as the baseline, only the highest quartile group is significantly different at 90% level. Nevertheless, results from regression 1 shows that income level (at least when comparing the highest quartile to the lowest quartile) is statistically significant at 99% level. The decrease in significance is due to the correlation between income level, and having driver's license and number of cars available. 

##Prediction
In addition to the odds ratio provided in the regression output, we want to be more specific with the size of effects of the seven independent variables. Therefore, the ranges of predicted probability based on the variation of different variables are provided as following.

```{r echo=F, warning=F, message=F, error=F, fig.cap=figcap("predict-by-age", "Predicted Probability of Having an Interest in EVs by Age and Sex"), fig.height=6}
ZP <- zelig(EVinterest ~ RAGE + Male + lowermiddle + highermiddle + high 
             + degree + licence + NumCar + NumDepCh + Scotland, 
             cite = FALSE, data = EVINTEREST, model = 'logit')
setZP1 <- setx(ZP, RAGE = 20:95, Male=0)
simZP1 <- sim(ZP, x = setZP1)
plot(simZP1, xlab="Age", ylab="Predicted Probability", col=rgb(1,0,0,0.15), 
     ylim=c(0,0.4), xlim=c(20,100))
par(new=T)
setZP1 <- setx(ZP, RAGE = 20:95, Male=1)
simZP1 <- sim(ZP, x = setZP1)
plot(simZP1, xlab="Age", ylab="Predicted Probability", col=rgb(0,0,1,0.15), 
     ylim=c(0,0.4), xlim=c(20,100))
legend("topright", c("Male","Female"),lwd=1, col=c("blue","red"))
```

`r figcap("predict-by-age", display="cite")` shows the predicted probability of having an interest in EVs by age and sex. Regardless of age, males show a greater interest than females. Even though the variation among males is larger too, the difference in probability is on average about 5 percentage points. The linear relationship between age and this probability is clearly demostrated here as well. Younger people are more likely to be interested than older people.

#Discussion

#Reference
